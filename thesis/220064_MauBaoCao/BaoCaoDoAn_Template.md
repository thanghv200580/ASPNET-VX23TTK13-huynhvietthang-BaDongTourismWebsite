# BÁO CÁO ĐỒ ÁN TỐT NGHIỆP

**TÊN ĐỀ TÀI:** Xây dựng Website Quản lý và Hỗ trợ Du lịch Ba Đồng (BaDongTourismWebsite)

**Họ và tên sinh viên:** Huỳnh Việt Thắng  
**Mã số sinh viên:** 220064
**Lớp:** VX23TTK13
**Khoa:** Công nghệ Thông tin  
**Giảng viên hướng dẫn:** TS. Đoàn Phước Miền

---

## NHẬN XÉT CỦA GIẢNG VIÊN HƯỚNG DẪN

_(Để trống - Giảng viên sẽ điền)_

**Nhận xét:**

- Về nội dung:
- Về hình thức:
- Về kết quả đạt được:
- Điểm hướng dẫn:

Trà Vinh, ngày …… tháng …… năm 2025

**Giáo viên hướng dẫn**

_(Ký tên và ghi rõ họ tên)_

---

## NHẬN XÉT CỦA THÀNH VIÊN HỘI ĐỒNG

_(Để trống - Thành viên hội đồng sẽ điền)_

**Nhận xét:**

- Nội dung trình bày:
- Khả năng trả lời câu hỏi:
- Điểm phản biện:

Trà Vinh, ngày …… tháng …… năm 2025

**Thành viên hội đồng**

_(Ký tên và ghi rõ họ tên)_

---

## LỜI CẢM ƠN

Sau một thời gian nghiên cứu và thực hiện, em xin trân trọng gửi lời cảm ơn sâu sắc nhất đến những người đã đồng hành và hỗ trợ em hoàn thành đồ án "Website Quản lý và Hỗ trợ Du lịch Ba Đồng".

Trước tiên, em xin bày tỏ lòng biết ơn chân thành đến TS. Đoàn Phước Miền - giảng viên hướng dẫn đồ án của em. Thầy đã tận tình chỉ bảo, định hướng và truyền đạt những kinh nghiệm quý báu về phát triển phần mềm, kiến trúc hệ thống và phương pháp luận nghiên cứu. Những góp ý chi tiết của Thầy về thiết kế cơ sở dữ liệu, phân lớp kiến trúc và các best practices đã giúp em xây dựng hệ thống một cách chuyên nghiệp và có tính mở rộng cao.

Em xin gửi lời cảm ơn đến quý Thầy Cô trong Khoa Công nghệ Thông tin - Trường Đại học Trà Vinh đã trang bị cho em nền tảng kiến thức vững chắc về lập trình web, cơ sở dữ liệu, mạng máy tính và kỹ thuật phần mềm. Những kiến thức này là hành trang quan trọng giúp em tự tin áp dụng công nghệ ASP.NET Core, Entity Framework Core, PostgreSQL và các design patterns vào dự án thực tế.

Em xin cảm ơn gia đình, bạn bè đã luôn động viên, khích lệ và tạo điều kiện thuận lợi cho em trong suốt thời gian học tập và thực hiện đồ án. Đặc biệt, em cảm ơn những người bạn đã nhiệt tình tham gia kiểm thử hệ thống và đóng góp những phản hồi quý giá giúp cải thiện chất lượng sản phẩm.

Quá trình thực hiện đồ án đã giúp em hiểu sâu hơn về quy trình phát triển phần mềm từ phân tích yêu cầu, thiết kế kiến trúc, triển khai code theo mô hình phân lớp, đến kiểm thử và triển khai hệ thống. Em hy vọng sản phẩm này không chỉ đáp ứng yêu cầu đồ án tốt nghiệp mà còn có thể ứng dụng thực tế để quảng bá du lịch địa phương và hỗ trợ khách du lịch khám phá vẻ đẹp Ba Đồng - Quảng Bình.

Một lần nữa, em xin chân thành cảm ơn!

---

## MỤC LỤC

_(Sẽ được tạo tự động khi xuất sang Word/PDF)_

**MỞ ĐẦU** ........................................................ 1

1. Lý do chọn đề tài ........................................... 1
2. Mục tiêu nghiên cứu ....................................... 2
3. Đối tượng và phạm vi nghiên cứu ........................ 2
4. Phương pháp nghiên cứu .................................. 3
5. Ý nghĩa của đề tài .......................................... 3

**CHƯƠNG 1: NGHIÊN CỨU LÝ THUYẾT** ................. 4
1.1. Cơ sở lý thuyết ........................................... 4
1.2. Công nghệ sử dụng ...................................... 6
1.3. Các Patterns và Best Practices áp dụng ............. 8
1.4. Bảo mật cơ bản ............................................ 10
1.5. Mô hình định giá động .................................. 11
1.6. Tóm tắt chương .......................................... 12

**CHƯƠNG 2: HIỆN THỰC HÓA NGHIÊN CỨU** ......... 13
2.1. Mô tả bài toán ............................................. 13
2.2. Yêu cầu chức năng ....................................... 15
2.3. Mô hình cơ sở dữ liệu .................................. 18
2.4. Lược đồ Use case ........................................ 21
2.5. Kiến trúc hệ thống ...................................... 24

**CHƯƠNG 3: KẾT QUẢ NGHIÊN CỨU** .................. 30
3.1. Giao diện và chức năng đã triển khai ............... 30
3.2. Kiểm thử và đánh giá .................................. 38
3.3. Kết quả đạt được ........................................ 42

**CHƯƠNG 4: KẾT LUẬN VÀ HƯỚNG PHÁT TRIỂN** ... 45
4.1. Kết luận .................................................... 45
4.2. Hạn chế .................................................... 46
4.3. Hướng phát triển ........................................ 47

**DANH MỤC TÀI LIỆU THAM KHẢO** ................... 67

**PHỤ LỤC** ..................................................... 68

---

## DANH MỤC HÌNH ẢNH

_(Sẽ được cập nhật khi chèn hình vào báo cáo)_

Hình 1.1: Kiến trúc ASP.NET Core Razor Pages ........................ 5
Hình 1.2: Entity Framework Core workflow .............................. 7
Hình 1.3: Repository Pattern và Unit of Work .......................... 9

Hình 2.1: Use-case diagram - Tổng quan hệ thống ..................... 16
Hình 2.2: ER Diagram - Toàn bộ cơ sở dữ liệu ......................... 18
Hình 2.3: Database relationships diagram ............................... 20

Hình 3.1: Kiến trúc 3-layer (Presentation - BLL - DAL) ............... 41
Hình 3.2: Dependency Injection flow diagram .......................... 43

Hình 4.1: Trang chủ MilkTeaWebsite ..................................... 46
Hình 4.2: Trang danh sách sản phẩm (Products List) .................. 47
Hình 4.3: Trang chi tiết sản phẩm với Size/Topping selector ......... 48
Hình 4.4: Giỏ hàng với tính năng cập nhật số lượng .................. 49
Hình 4.5: Trang thanh toán (Checkout form) ........................... 50
Hình 4.6: Trang lịch sử đơn hàng (Order History) ..................... 51
Hình 4.7: Staff Dashboard với widgets thống kê ...................... 52
Hình 4.8: Staff Order Management ...................................... 53
Hình 4.9: Admin Product Management (CRUD) ........................ 54
Hình 4.10: Login và Register pages ..................................... 55

---

## DANH MỤC BẢNG BIỂU

Bảng 2.1: Danh sách yêu cầu chức năng ................................ 12
Bảng 2.2: Danh sách yêu cầu phi chức năng ........................... 14
Bảng 2.3: Chi tiết bảng User ............................................. 21
Bảng 2.4: Chi tiết bảng Product .......................................... 22
Bảng 2.5: Chi tiết bảng Order và OrderDetail ......................... 23

Bảng 3.1: Công nghệ và thư viện sử dụng .............................. 26
Bảng 3.2: Cấu trúc thư mục Source Code ............................... 27
Bảng 3.3: Danh sách Services trong BLL ................................ 30

Bảng 4.1: Kết quả kiểm thử chức năng .................................. 57
Bảng 4.2: Kết quả performance testing .................................. 58
Bảng 4.3: Kết quả security testing ....................................... 59

---

## TÓM TẮT

Đồ án "BaDongTourismWebsite" xây dựng một nền tảng website du lịch toàn diện nhằm quảng bá và hỗ trợ phát triển du lịch tại khu vực Ba Đồng, Quảng Bình. Hệ thống cung cấp thông tin chi tiết về các điểm đến du lịch, tour du lịch, dịch vụ lưu trú và ẩm thực, đồng thời hỗ trợ khách hàng tra cứu thông tin, đánh giá điểm đến và quản lý đặt tour trực tuyến. Với phạm vi địa phương nhưng tiềm năng du lịch lớn, Ba Đồng cần một công cụ số hóa giúp du khách dễ dàng tiếp cận thông tin và nâng cao trải nghiệm khám phá vùng đất mới.

Hệ thống được phát triển trên nền tảng ASP.NET Core 9.0 sử dụng mô hình Razor Pages, kết hợp Entity Framework Core 9.0 và PostgreSQL 16 để quản lý dữ liệu. Kiến trúc ứng dụng tuân theo mô hình phân lớp rõ ràng gồm Presentation Layer (Razor Pages), Business Logic Layer (Services), Data Access Layer (Repositories) và Entity Layer, đảm bảo tách biệt trách nhiệm và dễ dàng bảo trì mở rộng. Hệ thống áp dụng các design patterns quan trọng như Repository Pattern, Unit of Work và Dependency Injection, giúp code có tính module hóa cao và thuận tiện cho việc kiểm thử.

Các chức năng chính của hệ thống bao gồm: quản lý thông tin điểm đến du lịch với phân loại theo danh mục (biển, núi, văn hóa, sinh thái), quản lý tour du lịch đa điểm với lịch trình chi tiết, hệ thống đánh giá và review từ người dùng, quản lý thông tin lưu trú và nhà hàng địa phương, phân quyền theo vai trò (Admin/Staff/Customer/Guest), và chức năng đặt tour với quy trình thanh toán. Giao diện người dùng được thiết kế hiện đại, responsive và thân thiện sử dụng Bootstrap 5 và các thư viện JavaScript, đảm bảo trải nghiệm tốt trên mọi thiết bị.

Phương pháp thực hiện đồ án tuân theo quy trình phát triển phần mềm có hệ thống, bao gồm các giai đoạn: phân tích yêu cầu nghiệp vụ du lịch, thiết kế cơ sở dữ liệu quan hệ với 14 bảng chính, xây dựng kiến trúc phân lớp với phân tách rõ ràng, triển khai từng module chức năng theo độ ưu tiên, kiểm thử chức năng và giao diện, và cuối cùng là triển khai hệ thống với Docker containerization. Hệ thống sử dụng PostgreSQL cho độ tin cậy cao và hỗ trợ JSONB cho dữ liệu mở rộng trong tương lai, BCrypt để mã hóa mật khẩu đảm bảo bảo mật, và áp dụng các biện pháp bảo mật cơ bản như CSRF protection, XSS prevention và role-based authorization.

Kết quả đạt được cho thấy hệ thống hoạt động ổn định với đầy đủ các chức năng cốt lõi đã đề ra. Cơ sở dữ liệu được thiết kế chuẩn hóa tốt với các ràng buộc toàn vẹn, hỗ trợ soft delete và audit fields để truy vết thay đổi. Giao diện người dùng trực quan với thiết kế modern blue theme, hiệu ứng hover và animation mượt mà, responsive tốt trên mobile và desktop. Hệ thống đã seed dữ liệu mẫu đầy đủ bao gồm 4 vai trò, 6 danh mục, 4 điểm đến, 2 tour, 2 accommodation và 2 nhà hàng để phục vụ demo và kiểm thử. Đồ án này chứng minh tính khả thi của việc áp dụng công nghệ .NET hiện đại vào lĩnh vực du lịch địa phương, tạo nền tảng cho việc phát triển thêm các tính năng nâng cao như tích hợp thanh toán trực tuyến, ứng dụng di động và phân tích dữ liệu khách hàng.

**Từ khóa:** du lịch điện tử, ASP.NET Core, Razor Pages, Entity Framework Core, PostgreSQL, kiến trúc phân lớp, Repository Pattern, quản lý tour, đánh giá điểm đến, phân quyền người dùng.

---

# CHƯƠNG 0: TỔNG QUAN

## 0.1. Bối cảnh nghiên cứu

Trong bối cảnh chuyển đổi số diễn ra mạnh mẽ tại Việt Nam, ngành du lịch đang từng bước ứng dụng công nghệ thông tin để nâng cao chất lượng dịch vụ và trải nghiệm khách hàng. Theo Tổng cục Du lịch, lượng khách du lịch nội địa và quốc tế đến Việt Nam tăng trưởng đều đặn hằng năm, đặc biệt sau đại dịch COVID-19, nhu cầu khám phá các điểm đến mới, các vùng đất có tiềm năng du lịch tự nhiên và văn hóa đang được du khách quan tâm nhiều hơn.

Ba Đồng, một xã thuộc tỉnh Quảng Bình, là vùng đất sở hữu nhiều tài nguyên du lịch quý giá bao gồm biển đảo đẹp, cảnh quan núi non hùng vĩ, văn hóa địa phương đặc sắc và hệ sinh thái phong phú. Tuy nhiên, do hạn chế về cơ sở hạ tầng thông tin và thiếu công cụ quảng bá chuyên nghiệp, tiềm năng du lịch của Ba Đồng chưa được khai thác hiệu quả. Du khách gặp khó khăn trong việc tiếp cận thông tin về điểm đến, dịch vụ lưu trú, ẩm thực và các tour du lịch, dẫn đến trải nghiệm chưa trọn vẹn và hạn chế khả năng phát triển du lịch bền vững.

Việc xây dựng một hệ thống website du lịch tổng hợp, cung cấp đầy đủ thông tin về điểm đến, tour, dịch vụ và hỗ trợ đặt chỗ trực tuyến là giải pháp cần thiết giúp kết nối du khách với các nhà cung cấp dịch vụ địa phương, đồng thời tạo công cụ quản lý hiệu quả cho các đơn vị kinh doanh du lịch. Hệ thống không chỉ giúp quảng bá hình ảnh Ba Đồng ra bên ngoài mà còn góp phần số hóa ngành du lịch địa phương, tạo nền tảng cho sự phát triển bền vững trong tương lai.

## 0.2. Vấn đề nghiên cứu

Hiện trạng du lịch tại Ba Đồng và các địa phương có quy mô tương tự đang đối mặt với nhiều thách thức trong việc quảng bá và quản lý thông tin du lịch. Cụ thể, các vấn đề cần giải quyết bao gồm:

**Thứ nhất**, thông tin du lịch phân tán và thiếu tính hệ thống. Thông tin về điểm đến, tour, dịch vụ lưu trú và ẩm thực thường nằm rải rác trên nhiều nguồn khác nhau như Facebook cá nhân, các group du lịch, hoặc truyền miệng. Việc này gây khó khăn cho du khách trong việc tìm kiếm và đối chiếu thông tin, đồng thời làm giảm độ tin cậy của nguồn thông tin.

**Thứ hai**, thiếu công cụ hỗ trợ đặt tour và dịch vụ trực tuyến. Hầu hết các giao dịch đặt tour, đặt phòng vẫn thực hiện qua điện thoại hoặc qua các ứng dụng nhắn tin chưa chuyên nghiệp, dẫn đến tình trạng nhầm lẫn thông tin, khó quản lý lịch trình và không có dữ liệu lưu trữ để phân tích nhu cầu khách hàng.

**Thứ ba**, chưa có cơ chế đánh giá và chia sẻ trải nghiệm từ du khách. Đánh giá và review là yếu tố quan trọng giúp du khách đưa ra quyết định lựa chọn điểm đến và dịch vụ. Tuy nhiên, hiện nay chưa có nền tảng tập trung để du khách có thể chia sẻ trải nghiệm và đánh giá các địa điểm, tour cũng như dịch vụ tại Ba Đồng một cách có hệ thống.

**Thứ tư**, khó khăn trong quản lý và cập nhật thông tin cho nhà cung cấp dịch vụ. Các chủ cơ sở lưu trú, nhà hàng, và đơn vị tổ chức tour địa phương thiếu công cụ để cập nhật thông tin dịch vụ, quản lý đặt chỗ và theo dõi khách hàng một cách hiệu quả. Điều này dẫn đến việc vận hành không chuyên nghiệp và khó mở rộng quy mô kinh doanh.

Từ những vấn đề trên, việc xây dựng một hệ thống website tổng hợp với đầy đủ chức năng quản lý thông tin du lịch, hỗ trợ đặt tour, đánh giá và phân quyền người dùng là cần thiết và cấp bách để thúc đẩy phát triển du lịch tại Ba Đồng.

## 0.3. Mục tiêu nghiên cứu

### 0.3.1. Mục tiêu chung

Xây dựng hệ thống website quản lý và hỗ trợ du lịch cho khu vực Ba Đồng, Quảng Bình, nhằm cung cấp nền tảng thông tin tổng hợp về các điểm đến du lịch, tour du lịch, dịch vụ lưu trú và ẩm thực, đồng thời hỗ trợ quy trình đặt tour trực tuyến và quản lý đánh giá từ du khách. Hệ thống được thiết kế theo kiến trúc phân lớp rõ ràng, áp dụng các design patterns hiện đại và đảm bảo tính bảo mật, khả năng mở rộng cho nhu cầu phát triển trong tương lai.

### 0.3.2. Mục tiêu cụ thể

Để đạt được mục tiêu chung, đồ án tập trung vào các mục tiêu cụ thể sau:

**Về chức năng nghiệp vụ:**

- Xây dựng module quản lý thông tin điểm đến du lịch với phân loại theo danh mục (biển, núi, văn hóa, lịch sử, sinh thái, ẩm thực), bao gồm mô tả chi tiết, hình ảnh, vị trí địa lý và đánh giá.
- Phát triển module quản lý tour du lịch đa điểm với lịch trình chi tiết, thông tin giá cả, thời gian và số lượng người tham gia.
- Triển khai hệ thống đánh giá và review cho phép du khách chia sẻ trải nghiệm về điểm đến và tour, góp phần nâng cao chất lượng dịch vụ.
- Xây dựng module quản lý thông tin lưu trú và nhà hàng địa phương, hỗ trợ du khách tìm kiếm dịch vụ phù hợp.
- Phát triển quy trình đặt tour trực tuyến từ chọn tour, điền thông tin liên hệ đến xác nhận và quản lý trạng thái đơn đặt.

**Về kiến trúc và công nghệ:**

- Thiết kế và triển khai kiến trúc phân lớp 4 tầng (Presentation, Business Logic, Data Access, Entity) đảm bảo tách biệt trách nhiệm và dễ bảo trì.
- Áp dụng các design patterns quan trọng như Repository Pattern, Unit of Work và Dependency Injection để tăng tính module hóa.
- Sử dụng ASP.NET Core 9.0 với Razor Pages, Entity Framework Core 9.0 và PostgreSQL 16 để xây dựng hệ thống hiệu năng cao và bảo mật.
- Thiết kế cơ sở dữ liệu quan hệ chuẩn hóa với 14 bảng chính, đảm bảo tính toàn vẹn dữ liệu và hỗ trợ các tính năng soft delete, audit fields.

**Về giao diện và trải nghiệm người dùng:**

- Thiết kế giao diện người dùng hiện đại, thân thiện và responsive, hoạt động tốt trên cả máy tính và thiết bị di động.
- Phân quyền rõ ràng theo vai trò (Admin, Staff, Customer, Guest) với các chức năng phù hợp cho từng nhóm người dùng.
- Xây dựng các trang quản trị (Admin Dashboard) giúp quản lý dễ dàng thực hiện CRUD trên các entity chính.

**Về bảo mật và chất lượng:**

- Triển khai các biện pháp bảo mật cơ bản như mã hóa mật khẩu (BCrypt), CSRF protection, XSS prevention và role-based authorization.
- Đảm bảo mã nguồn có cấu trúc rõ ràng, tuân thủ coding conventions và dễ dàng kiểm thử.

## 0.4. Đối tượng và phạm vi nghiên cứu

### 0.4.1. Đối tượng nghiên cứu

Đối tượng nghiên cứu của đồ án là hệ thống phần mềm website du lịch điện tử, bao gồm các thành phần chính:

- **Front-office:** Giao diện dành cho du khách (Guest và Customer) để duyệt thông tin điểm đến, xem chi tiết tour, đọc review, tra cứu dịch vụ lưu trú/ẩm thực và thực hiện đặt tour.
- **Back-office:** Giao diện quản trị dành cho Admin và Staff để quản lý toàn bộ dữ liệu hệ thống bao gồm điểm đến, tour, booking, user, category và các entity liên quan.
- **Kiến trúc phần mềm:** Mô hình phân lớp 4 tầng với việc áp dụng các design patterns và best practices trong phát triển phần mềm.
- **Cơ sở dữ liệu:** Hệ quản trị cơ sở dữ liệu quan hệ PostgreSQL với schema chuẩn hóa, các ràng buộc toàn vẹn và cơ chế migration.

### 0.4.2. Phạm vi nghiên cứu

**Phạm vi về chức năng:**

Đồ án tập trung triển khai các chức năng cốt lõi của một hệ thống du lịch điện tử cơ bản, bao gồm:

- Quản lý đầy đủ thông tin điểm đến du lịch (Destinations) với hình ảnh, mô tả, phân loại và đánh giá.
- Quản lý tour du lịch đa điểm (Tours) với lịch trình chi tiết, giá cả và thông tin người tham gia.
- Hệ thống đánh giá và review (Reviews) cho điểm đến và tour.
- Quản lý thông tin lưu trú (Accommodations) và nhà hàng (Restaurants).
- Quy trình đặt tour (Bookings) với các trạng thái: Pending, Confirmed, Cancelled, Completed.
- Quản lý thanh toán (Payments) với các phương thức và trạng thái thanh toán.
- Phân quyền người dùng (Users, Roles) với 4 vai trò: Admin, Staff, Customer, Guest.

**Phạm vi về công nghệ:**

Hệ thống được xây dựng trên nền tảng:

- Backend: ASP.NET Core 9.0 với Razor Pages
- ORM: Entity Framework Core 9.0
- Database: PostgreSQL 16
- Frontend: HTML5, CSS3 (Bootstrap 5), JavaScript (vanilla JS, không sử dụng framework phức tạp)
- Containerization: Docker và Docker Compose cho việc triển khai database

**Phạm vi không bao gồm:**

Để phù hợp với thời gian và nguồn lực của đồ án tốt nghiệp, các tính năng sau không nằm trong phạm vi nghiên cứu:

- Tích hợp cổng thanh toán trực tuyến thực tế (VNPay, Momo, ZaloPay).
- Ứng dụng di động native (iOS, Android).
- Tính năng chat realtime giữa khách hàng và nhà cung cấp dịch vụ.
- API công khai (Public API) cho bên thứ ba.
- Hệ thống quản lý tồn kho và logistics phức tạp.
- Tính năng AI/ML như gợi ý điểm đến thông minh dựa trên hành vi người dùng.
- Tích hợp bản đồ tương tác (Google Maps API) - chỉ hiển thị thông tin vị trí text.

## 0.5. Phương pháp nghiên cứu

Đồ án áp dụng phương pháp nghiên cứu và phát triển phần mềm có hệ thống, kết hợp giữa nghiên cứu lý thuyết và thực hành triển khai. Quy trình thực hiện được chia thành các giai đoạn rõ ràng:

**Giai đoạn 1: Nghiên cứu lý thuyết và công nghệ**

Nghiên cứu tài liệu về kiến trúc ứng dụng web trên nền tảng .NET, so sánh các mô hình MVC, Razor Pages và SPA để lựa chọn phù hợp với phạm vi dự án. Tìm hiểu Entity Framework Core về cơ chế ORM, Change Tracking, Migration và các kỹ thuật tối ưu truy vấn. Nghiên cứu PostgreSQL về các tính năng nổi bật như JSONB, indexing nâng cao và so sánh với SQL Server. Nghiên cứu các design patterns quan trọng như Repository Pattern, Unit of Work, Dependency Injection và cách áp dụng vào kiến trúc phân lớp.

**Giai đoạn 2: Phân tích yêu cầu nghiệp vụ**

Xác định các yêu cầu chức năng cốt lõi của hệ thống du lịch bao gồm quản lý điểm đến, tour, booking, review và dịch vụ. Phân tích các actor (Admin, Staff, Customer, Guest) và use cases tương ứng. Xác định yêu cầu phi chức năng về bảo mật, hiệu năng, khả năng mở rộng và trải nghiệm người dùng. Tham khảo các hệ thống du lịch hiện có để rút ra bài học kinh nghiệm.

**Giai đoạn 3: Thiết kế hệ thống**

Thiết kế kiến trúc phân lớp 4 tầng (Presentation - BLL - DAL - Entity) với sơ đồ package và component diagram. Thiết kế cơ sở dữ liệu quan hệ với ER Diagram bao gồm 14 bảng chính, xác định các quan hệ (1-1, 1-n, n-n), primary key, foreign key và các ràng buộc toàn vẹn. Thiết kế schema database với soft delete (IsDeleted), audit fields (CreatedDate, UpdatedDate) và indexing cho các trường thường xuyên truy vấn. Thiết kế Use Case Diagram và Activity Diagram cho các nghiệp vụ chính. Thiết kế giao diện người dùng với wireframe và mockup cho các trang quan trọng.

**Giai đoạn 4: Triển khai hệ thống**

Khởi tạo solution ASP.NET Core với cấu trúc multi-project theo kiến trúc phân lớp. Triển khai Entity Layer với các entity classes và validation attributes. Triển khai DAL với ApplicationDbContext, các Repository implementations và Migration. Triển khai BLL với các Service classes chứa business logic. Triển khai Presentation Layer với Razor Pages cho front-office và back-office. Cấu hình Dependency Injection container và middleware pipeline. Seed dữ liệu mẫu bao gồm roles, users, categories, destinations, tours, reviews, accommodations và restaurants.

**Giai đoạn 5: Kiểm thử và đánh giá**

Kiểm thử chức năng (Functional Testing) cho từng module: đăng nhập/đăng ký, CRUD operations, booking flow, review system. Kiểm thử bảo mật cơ bản: xác thực mật khẩu, phân quyền, CSRF protection, XSS prevention. Kiểm thử giao diện (UI Testing) trên nhiều trình duyệt và thiết bị khác nhau. Kiểm thử hiệu năng cơ bản: thời gian load trang, số lượng queries, N+1 query problem. Thu thập feedback từ người dùng thử nghiệm để cải thiện trải nghiệm.

**Giai đoạn 6: Tài liệu hóa**

Viết báo cáo đồ án với đầy đủ các chương: Tổng quan, Nghiên cứu lý thuyết, Hiện thực hóa nghiên cứu, Kết quả nghiên cứu, Kết luận và hướng phát triển. Tạo tài liệu hướng dẫn sử dụng cho end-user và tài liệu kỹ thuật cho developer. Chuẩn bị slide thuyết trình và demo sản phẩm.

## 0.6. Ý nghĩa khoa học và thực tiễn

### 0.6.1. Ý nghĩa khoa học

Về mặt học thuật, đồ án cung cấp một nghiên cứu trường hợp (case study) cụ thể về việc áp dụng kiến trúc phân lớp và các design patterns trong phát triển ứng dụng web du lịch. Đồ án minh họa rõ ràng cách triển khai Repository Pattern và Unit of Work kết hợp với Entity Framework Core trong một domain có nhiều entity phức tạp và các quan hệ đa dạng (1-1, 1-n, n-n).

Nghiên cứu so sánh chi tiết giữa các lựa chọn kiến trúc (Razor Pages vs MVC vs SPA) giúp làm rõ ưu và nhược điểm của từng tiếp cận trong bối cảnh dự án quy mô vừa với nguồn lực hạn chế. Đặc biệt, đồ án chứng minh rằng Razor Pages là lựa chọn phù hợp cho các ứng dụng có yêu cầu CRUD phổ biến, ít logic phức tạp ở client-side, và cần thời gian phát triển nhanh.

Việc lựa chọn PostgreSQL thay vì SQL Server được phân tích dựa trên các tiêu chí kỹ thuật cụ thể như chi phí license, hỗ trợ JSONB, indexing nâng cao và tính mở rộng, cung cấp góc nhìn thực tế về quyết định công nghệ trong dự án thực tế. Đồ án cũng hệ thống hóa quy trình seed data và migration management, giúp các sinh viên và developer khác có tài liệu tham khảo khi xây dựng hệ thống tương tự.

### 0.6.2. Ý nghĩa thực tiễn

Về mặt thực tiễn, hệ thống góp phần giải quyết bài toán thực tế về quảng bá và quản lý thông tin du lịch cho khu vực Ba Đồng, Quảng Bình. Website cung cấp nền tảng tập trung để du khách có thể dễ dàng tiếp cận thông tin về các điểm đến, tour, dịch vụ lưu trú và ẩm thực, từ đó đưa ra quyết định du lịch phù hợp.

Hệ thống đánh giá và review giúp tạo niềm tin cho du khách khi lựa chọn dịch vụ, đồng thời tạo động lực cho các nhà cung cấp dịch vụ địa phương nâng cao chất lượng. Chức năng đặt tour trực tuyến giúp chuẩn hóa quy trình, giảm thiểu nhầm lẫn và tạo dữ liệu lưu trữ để phân tích nhu cầu khách hàng.

Đối với các đơn vị kinh doanh du lịch địa phương, hệ thống cung cấp công cụ quản lý chuyên nghiệp giúp cập nhật thông tin dịch vụ, theo dõi đơn đặt chỗ và quản lý khách hàng hiệu quả hơn. Điều này góp phần nâng cao tính chuyên nghiệp trong kinh doanh du lịch và tạo điều kiện mở rộng quy mô.

Về lâu dài, hệ thống có thể mở rộng thêm các tính năng như tích hợp thanh toán trực tuyến, phân tích dữ liệu khách hàng, gợi ý điểm đến thông minh và ứng dụng di động, góp phần xây dựng hệ sinh thái du lịch số hoàn chỉnh cho Ba Đồng và các địa phương khác có nhu cầu tương tự.

## 0.7. Cấu trúc báo cáo

Báo cáo đồ án được tổ chức thành các chương với nội dung chi tiết như sau:

**Chương 0: Tổng quan** - Giới thiệu bối cảnh nghiên cứu, vấn đề cần giải quyết, mục tiêu, đối tượng và phạm vi nghiên cứu, phương pháp thực hiện cùng ý nghĩa khoa học và thực tiễn của đề tài.

**Chương 1: Nghiên cứu lý thuyết** - Trình bày cơ sở lý thuyết về kiến trúc ứng dụng web trên .NET (Razor Pages, MVC, SPA), Entity Framework Core và PostgreSQL. Phân tích chi tiết các design patterns áp dụng (Repository, Unit of Work, Dependency Injection), các khía cạnh bảo mật cơ bản và kết luận lựa chọn công nghệ.

**Chương 2: Hiện thực hóa nghiên cứu** - Mô tả chi tiết bài toán du lịch Ba Đồng, phân tích yêu cầu chức năng và phi chức năng, thiết kế cơ sở dữ liệu với ER Diagram, Use Case Diagram và kiến trúc hệ thống 4 lớp. Trình bày chi tiết cấu trúc source code và workflow của các module chính.

**Chương 3: Kết quả nghiên cứu** - Trình bày giao diện và chức năng đã triển khai cho từng nhóm người dùng (Guest/Customer, Staff, Admin), kết quả kiểm thử chức năng, bảo mật và hiệu năng cơ bản. Đánh giá tổng thể về hệ thống đã xây dựng.

**Chương 4: Kết luận và hướng phát triển** - Tổng kết những gì đã đạt được, các hạn chế còn tồn tại và đề xuất hướng phát triển trong tương lai như tích hợp thanh toán, xây dựng mobile app, áp dụng AI/ML cho gợi ý thông minh.

---

# CHƯƠNG 1: CƠ SỞ LÝ THUYẾT VÀ CÔNG NGHỆ

Chương này trình bày các khái niệm lý thuyết nền tảng, công nghệ và các design patterns được áp dụng trong quá trình xây dựng hệ thống. Nội dung bao gồm kiến trúc ứng dụng web trên nền tảng .NET, Entity Framework Core, hệ quản trị cơ sở dữ liệu PostgreSQL, các mẫu thiết kế phần mềm và các khía cạnh về bảo mật ứng dụng web.

## 1.1. Tổng quan về ASP.NET Core và kiến trúc ứng dụng web

### 1.1.1. Giới thiệu ASP.NET Core

ASP.NET Core là framework phát triển ứng dụng web đa nền tảng, mã nguồn mở được Microsoft phát triển và duy trì. Phiên bản hiện tại (9.0) được sử dụng trong đồ án mang lại nhiều cải tiến về hiệu năng, bảo mật và khả năng mở rộng so với các phiên bản trước. Framework này hỗ trợ xây dựng ứng dụng web hiện đại với kiến trúc modular, cho phép developer tùy chỉnh middleware pipeline và dependency injection container một cách linh hoạt.

ASP.NET Core cung cấp nhiều mô hình lập trình khác nhau bao gồm Model-View-Controller (MVC), Razor Pages, Blazor và Web API. Mỗi mô hình có ưu điểm riêng phù hợp với các loại ứng dụng khác nhau. Việc lựa chọn mô hình lập trình phù hợp phụ thuộc vào độ phức tạp của domain nghiệp vụ, yêu cầu về tương tác phía client và quy mô dự án.

### 1.1.2. Razor Pages - Mô hình lập trình page-centric

Razor Pages là mô hình lập trình được giới thiệu từ ASP.NET Core 2.0, tập trung vào việc xây dựng ứng dụng theo hướng page-centric. Khác với MVC truyền thống nơi logic được phân tán trong nhiều controllers và actions, Razor Pages tổ chức code theo từng trang riêng biệt, mỗi trang bao gồm một file cshtml (view) và một file cs (PageModel) chứa logic xử lý.

Cấu trúc này mang lại nhiều lợi ích cho các dự án quy mô vừa và nhỏ. Thứ nhất, code organization rõ ràng hơn khi tất cả logic liên quan đến một trang được đặt cùng nhau, giảm thiểu việc phải nhảy giữa nhiều file như trong MVC. Thứ hai, routing được đơn giản hóa theo cấu trúc thư mục, không cần cấu hình route phức tạp. Thứ ba, giảm boilerplate code vì không cần tạo controller riêng cho mỗi nhóm chức năng nhỏ.

Trong hệ thống BaDongTourismWebsite, Razor Pages được sử dụng để xây dựng các trang front-office (trang chủ, danh sách điểm đến, chi tiết tour) và back-office (quản lý destinations, tours, bookings). Mỗi PageModel chứa các handler methods như OnGet, OnPost để xử lý HTTP requests, và có thể inject các services thông qua constructor injection.

**[Ghi chú hình ảnh 1.1: Minh họa cấu trúc Razor Pages với file cshtml và PageModel, so sánh với cấu trúc MVC truyền thống]**

### 1.1.3. So sánh Razor Pages với các mô hình khác

Khi lựa chọn kiến trúc cho dự án, cần xem xét nhiều yếu tố khác nhau. MVC (Model-View-Controller) là mô hình truyền thống với controller chứa nhiều actions, view được render từ controller, và model đại diện cho dữ liệu. MVC phù hợp với các ứng dụng lớn có nhiều module phức tạp, cần tái sử dụng logic giữa các actions khác nhau.

Razor Pages phù hợp hơn cho các ứng dụng có nghiệp vụ tập trung vào CRUD operations, không có quá nhiều logic phức tạp ở client-side. Đối với dự án du lịch Ba Đồng với yêu cầu chính là hiển thị thông tin, quản lý dữ liệu và một số tương tác đơn giản, Razor Pages là lựa chọn tối ưu vì giảm độ phức tạp trong cấu trúc code và thời gian phát triển.

Single Page Application (SPA) sử dụng framework như Angular, React hay Vue.js ở phía client, kết hợp với Web API ở backend. SPA mang lại trải nghiệm người dùng mượt mà với client-side routing và state management, tuy nhiên yêu cầu thiết lập phức tạp hơn với bundler (Webpack, Vite), phải xây dựng API layer riêng biệt, và cần xử lý state store phức tạp. Đối với phạm vi đồ án với nguồn lực và thời gian có hạn, SPA sẽ tạo thêm overhead không cần thiết.

Blazor là công nghệ mới cho phép chạy C# trên browser thông qua WebAssembly hoặc SignalR. Mặc dù Blazor có tiềm năng lớn cho tương lai, nhưng hiện tại vẫn còn nhiều hạn chế về ecosystem, debugging tools và hiệu năng với các ứng dụng lớn. Do đó, Razor Pages vẫn là lựa chọn ổn định và phù hợp nhất cho dự án này.

### 1.1.4. Middleware pipeline và request processing

ASP.NET Core sử dụng middleware pipeline để xử lý HTTP requests. Mỗi middleware component có thể xử lý request trước khi chuyển tiếp cho middleware tiếp theo hoặc ngắn mạch pipeline và trả về response ngay lập tức. Pipeline được cấu hình trong file Program.cs với thứ tự cụ thể để đảm bảo security, routing và error handling hoạt động đúng.

Trong hệ thống BaDongTourismWebsite, middleware pipeline bao gồm các components quan trọng: Exception Handler middleware xử lý lỗi toàn cục, HSTS middleware thêm security headers, Static Files middleware phục vụ CSS/JS/images, Routing middleware xác định endpoint phù hợp, Authentication và Authorization middleware kiểm tra quyền truy cập, Session middleware quản lý phiên làm việc, và cuối cùng là Endpoint middleware thực thi PageModel tương ứng.

Việc hiểu rõ middleware pipeline giúp developer có thể thêm custom middleware khi cần thiết, ví dụ như logging middleware để ghi lại mọi request, hoặc rate limiting middleware để ngăn chặn tấn công DDoS.

## 1.2. Entity Framework Core và Object-Relational Mapping

### 1.2.1. Giới thiệu Entity Framework Core

Entity Framework Core (EF Core) là một Object-Relational Mapper (ORM) hiện đại cho .NET, cho phép developers làm việc với cơ sở dữ liệu sử dụng các đối tượng .NET thay vì viết SQL trực tiếp. Phiên bản 9.0 được sử dụng trong đồ án mang lại nhiều cải tiến về performance, hỗ trợ các tính năng database mới và cải thiện trải nghiệm developer.

EF Core hoạt động theo nguyên tắc Code First, nghĩa là developer định nghĩa các entity classes trong code, sau đó EF Core tự động tạo database schema tương ứng thông qua migrations. Cách tiếp cận này mang lại nhiều lợi ích: giữ code là single source of truth, dễ dàng version control cho database schema, và có thể tái tạo database ở bất kỳ môi trường nào từ migrations.

### 1.2.2. Change Tracking và DbContext lifecycle

DbContext là thành phần trung tâm trong EF Core, đại diện cho một phiên làm việc với database. Mỗi DbContext instance theo dõi trạng thái của các entities được query hoặc attach vào context. Change Tracking là cơ chế tự động phát hiện những thay đổi trên entities và generate SQL commands phù hợp khi SaveChanges được gọi.

Khi một entity được query từ database, EF Core tạo snapshot của entity state. Khi properties của entity thay đổi, EF Core so sánh với snapshot để xác định các trường nào đã modified. Điều này cho phép EF Core chỉ cập nhật những cột thay đổi thay vì cập nhật toàn bộ record, tối ưu hiệu năng.

Tuy nhiên, Change Tracking cũng có chi phí về memory và processing. Đối với các truy vấn read-only không cần tracking, nên sử dụng AsNoTracking() để tắt change tracking, giảm memory footprint và tăng performance. Trong hệ thống BaDongTourismWebsite, AsNoTracking được áp dụng cho các queries lấy danh sách destinations, tours để hiển thị trên trang chủ vì không có nhu cầu cập nhật.

### 1.2.3. LINQ to Entities và query translation

Language Integrated Query (LINQ) cho phép viết queries sử dụng C# syntax thay vì SQL. EF Core sẽ translate LINQ expressions sang SQL tương ứng với database provider đang sử dụng. Quá trình translation diễn ra qua nhiều bước: parse expression tree, optimize query tree, và cuối cùng generate SQL statement.

Việc sử dụng LINQ mang lại nhiều lợi ích: type-safe queries được kiểm tra tại compile-time, IntelliSense support giúp autocomplete, refactoring dễ dàng hơn so với SQL strings, và có thể compose queries một cách linh hoạt. Tuy nhiên, developer cần hiểu rõ cách LINQ được translated để tránh các vấn đề về performance như N+1 query problem.

N+1 query problem xảy ra khi load một collection entities rồi trong vòng lặp lại load related entities, gây ra N queries bổ sung. Để giải quyết, EF Core cung cấp Include() method để eager loading related data trong một query duy nhất. Trong dự án, Include được sử dụng khi load Destination cùng với Category và Images, hoặc load Tour cùng với TourDestinations.

**[Ghi chú hình ảnh 1.2: Workflow của EF Core từ LINQ expression đến SQL execution, minh họa Change Tracking mechanism]**

### 1.2.4. Migrations và database schema management

Migrations là cơ chế version control cho database schema trong EF Core. Mỗi khi có thay đổi về entity model (thêm property, thay đổi relationship, v.v.), developer tạo một migration mới chứa code để update hoặc revert schema changes. Migrations được lưu dưới dạng code trong project, có thể commit vào source control và apply trên các environments khác nhau.

Quy trình làm việc với migrations bao gồm các bước: thay đổi entity classes, chạy lệnh tạo migration để EF Core generate migration code, review migration code để đảm bảo đúng ý định, và cuối cùng apply migration lên database. EF Core hỗ trợ cả automatic migrations (tự động generate) và custom migrations (viết SQL thủ công cho các trường hợp đặc biệt).

Trong hệ thống BaDongTourismWebsite, migration ban đầu được tạo với tên "InitialCreate" chứa toàn bộ 14 bảng: Users, Roles, UserRoles, Categories, Destinations, DestinationImages, Tours, TourDestinations, TourSchedules, Bookings, Payments, Reviews, Accommodations và Restaurants. Migration này tạo tables với đầy đủ constraints (primary keys, foreign keys, unique indexes) và default values.

## 1.3. PostgreSQL - Hệ quản trị cơ sở dữ liệu quan hệ

### 1.3.1. Tổng quan về PostgreSQL

PostgreSQL là hệ quản trị cơ sở dữ liệu quan hệ mã nguồn mở, được phát triển từ năm 1986 tại University of California, Berkeley. Phiên bản 16 được sử dụng trong đồ án là phiên bản mới nhất (tại thời điểm thực hiện) với nhiều cải tiến về performance, security và các tính năng mới.

PostgreSQL tuân thủ nghiêm ngặt chuẩn SQL, đồng thời cung cấp nhiều tính năng mở rộng độc đáo. Hệ thống sử dụng kiến trúc client-server với process-based model, mỗi connection được xử lý bởi một backend process riêng. Điều này mang lại tính isolation tốt giữa các connections, tránh ảnh hưởng lẫn nhau khi có lỗi xảy ra.

### 1.3.2. ACID và transaction management

ACID (Atomicity, Consistency, Isolation, Durability) là bốn tính chất quan trọng của một transaction trong database. PostgreSQL đảm bảo đầy đủ các tính chất này thông qua các cơ chế kỹ thuật tiên tiến.

Atomicity đảm bảo transaction thực hiện hoàn toàn hoặc không thực hiện gì cả, không có trạng thái trung gian. Nếu một phần của transaction fails, toàn bộ transaction sẽ được rollback. Consistency đảm bảo database luôn ở trạng thái valid sau mỗi transaction, tất cả constraints được kiểm tra và enforce.

Isolation đảm bảo các transactions đồng thời không ảnh hưởng lẫn nhau. PostgreSQL hỗ trợ nhiều isolation levels khác nhau: Read Uncommitted, Read Committed (default), Repeatable Read và Serializable. Mỗi level có trade-off khác nhau giữa consistency và concurrency. Durability đảm bảo dữ liệu đã commit không bị mất ngay cả khi hệ thống crash, thông qua Write-Ahead Logging (WAL).

### 1.3.3. MVCC và concurrency control

Multi-Version Concurrency Control (MVCC) là kỹ thuật quản lý đồng thời độc đáo của PostgreSQL. Thay vì lock rows khi read hoặc write như các database truyền thống, MVCC tạo ra multiple versions của mỗi row, cho phép readers và writers hoạt động song song mà không block lẫn nhau.

Khi một row được update, PostgreSQL không ghi đè row cũ mà tạo một version mới với transaction ID tương ứng. Mỗi transaction có một snapshot ID riêng, chỉ thấy được những versions có transaction ID nhỏ hơn snapshot ID của mình. Cơ chế này loại bỏ read locks, tăng đáng kể concurrency và throughput.

Tuy nhiên, MVCC cũng tạo ra dead tuples (old versions không còn cần thiết) cần được dọn dẹp định kỳ thông qua autovacuum process. PostgreSQL tự động chạy vacuum để reclaim storage và update statistics, nhưng đối với tables có write-heavy workload, cần cấu hình vacuum parameters phù hợp để tránh table bloat.

### 1.3.4. Indexing và query optimization

PostgreSQL hỗ trợ nhiều loại index khác nhau phù hợp với các use cases khác nhau. B-tree index (default) phù hợp cho các queries có equality và range conditions, được sử dụng cho primary keys và foreign keys. Hash index hiệu quả cho equality comparisons nhưng không hỗ trợ range queries.

GIN (Generalized Inverted Index) và GiST (Generalized Search Tree) là hai loại index nâng cao. GIN phù hợp cho full-text search và JSONB queries, cho phép index các elements trong array hoặc keys trong JSON document. GiST hỗ trợ geometric data types và custom data types với các operators phức tạp.

Trong hệ thống BaDongTourismWebsite, indexes được tạo tự động cho primary keys, foreign keys và unique constraints. Ngoài ra, index được thêm cho cột Name trong bảng Destinations và Province để tăng tốc các queries search và filter. Index cũng được tạo cho cột StartDate trong bảng Tours để tối ưu queries lấy các tours sắp diễn ra.

### 1.3.5. JSONB và dữ liệu bán cấu trúc

JSONB là kiểu dữ liệu binary JSON trong PostgreSQL, lưu trữ JSON documents dưới dạng decomposed binary format. Khác với JSON type (lưu text), JSONB parse và validate data ngay khi insert, loại bỏ whitespace và duplicate keys. Điều này làm insert chậm hơn nhưng queries nhanh hơn đáng kể.

JSONB cho phép lưu trữ dữ liệu có cấu trúc linh động mà không cần định nghĩa schema cứng nhắc. Các operators như ->, ->>, @>, ? hỗ trợ navigate và query trong JSON document. GIN index trên JSONB columns cho phép index toàn bộ document hoặc chỉ specific paths, tăng tốc queries lên nhiều lần.

Trong dự án hiện tại, JSONB chưa được sử dụng nhưng có thể áp dụng trong tương lai cho các use cases như: lưu cấu hình settings linh động cho mỗi destination, store custom attributes không chuẩn hóa, hoặc log audit trail dưới dạng JSON documents để dễ dàng query và analyze.

**[Ghi chú hình ảnh 1.3: So sánh kiến trúc PostgreSQL vs SQL Server, minh họa MVCC mechanism]**

### 1.3.6. So sánh PostgreSQL và SQL Server

Việc lựa chọn PostgreSQL thay vì SQL Server trong dự án này dựa trên nhiều yếu tố kỹ thuật và thực tiễn. Về chi phí triển khai, PostgreSQL là giải pháp open-source hoàn toàn miễn phí, không có chi phí licensing bất kể quy mô deployment. SQL Server bản Enterprise có chi phí licensing cao, bản Express miễn phí nhưng có nhiều giới hạn về database size, memory và compute.

Về mặt kỹ thuật, PostgreSQL cung cấp support tốt hơn cho dữ liệu bán cấu trúc thông qua JSONB type với GIN indexing, trong khi SQL Server chỉ có JSON type dạng text không được optimize cho queries. Indexing capabilities của PostgreSQL đa dạng hơn với GIN, GiST, SP-GiST, BRIN indexes, phù hợp cho nhiều use cases khác nhau. SQL Server mạnh về columnstore indexes nhưng điều này vượt nhu cầu của dự án quy mô nhỏ.

Về deployment flexibility, PostgreSQL chạy tốt trên mọi platform (Windows, Linux, MacOS) và dễ dàng containerize với Docker. SQL Server tuy có Linux version nhưng ecosystem chủ yếu tập trung trên Windows và Azure. Điều này có thể tạo vendor lock-in nếu sau này muốn migrate sang cloud provider khác hoặc self-hosted environment.

Về community và extensions, PostgreSQL có ecosystem phong phú với nhiều extensions như pg_trgm (fuzzy text search), PostGIS (geographic data), pgcrypto (encryption), giúp mở rộng chức năng mà không cần third-party tools. SQL Server có CLR integration và Analysis Services nhưng phức tạp hơn cho các dự án nhỏ.

## 1.4. Các mẫu thiết kế phần mềm áp dụng

### 1.4.1. Repository Pattern - Tách biệt tầng dữ liệu

Repository Pattern là một trong những design patterns quan trọng nhất được áp dụng trong hệ thống, nhằm tạo abstraction layer giữa business logic và data access logic. Pattern này định nghĩa một interface cho các operations truy cập dữ liệu, với implementation cụ thể ẩn sau interface đó.

Trong hệ thống BaDongTourismWebsite, mỗi entity chính đều có một repository tương ứng. Ví dụ, IDestinationRepository định nghĩa các methods như GetAllDestinationsAsync, GetDestinationByIdAsync, GetFeaturedDestinationsAsync, AddDestinationAsync, UpdateDestinationAsync và DeleteDestinationAsync. Class DestinationRepository implements interface này, chứa logic cụ thể sử dụng EF Core để interact với database.

Lợi ích chính của Repository Pattern là separation of concerns. Business logic ở BLL layer không cần biết cách data được lưu trữ và truy vấn như thế nào, chỉ cần gọi methods từ repository interface. Điều này giúp code dễ test hơn vì có thể mock repositories trong unit tests, không cần kết nối database thật. Ngoài ra, nếu sau này muốn đổi từ EF Core sang Dapper hoặc một ORM khác, chỉ cần thay đổi implementation của repositories mà không ảnh hưởng đến business logic.

Repository Pattern cũng giúp tránh code duplication. Các queries phức tạp được encapsulate trong repository methods, có thể tái sử dụng ở nhiều nơi trong ứng dụng. Thay vì viết lại LINQ query mỗi khi cần load destinations với categories và images, chỉ cần gọi một method từ repository.

**[Ghi chú hình ảnh 1.4: Sơ đồ Repository Pattern với DestinationRepository, interface và implementation]**

### 1.4.2. Unit of Work Pattern - Quản lý transactions

Unit of Work Pattern quản lý transactions và coordinate việc lưu trữ nhiều changes vào database như một unit duy nhất. Pattern này đảm bảo tất cả changes đều succeed hoặc tất cả đều fail (atomicity), duy trì data consistency.

Trong ASP.NET Core với EF Core, DbContext đóng vai trò là một Unit of Work implicit. Mỗi DbContext instance track tất cả changes trên các entities, và khi SaveChanges được gọi, tất cả changes được commit trong một database transaction. Nếu có bất kỳ operation nào fail, toàn bộ transaction sẽ rollback, database không bị ở trạng thái inconsistent.

Hệ thống BaDongTourismWebsite định nghĩa IUnitOfWork interface với các properties để access repositories và method SaveChangesAsync để commit transaction. UnitOfWork class implements interface này, maintain một DbContext instance duy nhất và provide access đến tất cả repositories. Mỗi repository instance được tạo từ cùng một DbContext, đảm bảo tất cả operations trong cùng một scope share cùng context.

Ví dụ, khi tạo một booking mới, cần insert record vào Bookings table và có thể cần update thông tin trong Tours table (giảm số chỗ available). Hai operations này phải được thực hiện atomically. Nếu insert booking thành công nhưng update tour fail, data sẽ inconsistent. Unit of Work đảm bảo cả hai operations đều succeed hoặc không operation nào được apply.

### 1.4.3. Dependency Injection - Giảm sự phụ thuộc

Dependency Injection (DI) là một design pattern trong đó dependencies của một class được "inject" từ bên ngoài thay vì class tự tạo dependencies. Pattern này là một form của Inversion of Control (IoC), giúp giảm coupling giữa các components và tăng testability.

ASP.NET Core có built-in DI container hỗ trợ constructor injection, property injection và method injection. Trong hệ thống, constructor injection được sử dụng chủ yếu. Các services được register trong Program.cs với các lifecycle khác nhau: Singleton (một instance cho toàn bộ application lifetime), Scoped (một instance per HTTP request), hoặc Transient (instance mới mỗi lần inject).

Repositories và services được register là Scoped để ensure mỗi HTTP request có một DbContext instance riêng, tránh conflicts giữa các requests đồng thời. DbContext không thread-safe, việc share một instance giữa nhiều requests sẽ gây ra race conditions. Scoped lifetime đảm bảo mỗi request có DbContext riêng, và DbContext được disposed tự động khi request ends.

Khi một PageModel cần access destination service, nó declare IDestinationService trong constructor. DI container tự động resolve dependency, tạo DestinationService instance với các dependencies của nó (như IUnitOfWork), và inject vào PageModel. Developer không cần manually instantiate dependencies, giảm boilerplate code và errors.

DI cũng giúp dễ dàng swap implementations. Trong development, có thể inject mock repositories trả về fake data để test business logic mà không cần database. Trong production, inject real repositories connecting đến PostgreSQL. Code consuming services không cần thay đổi gì.

**[Ghi chú hình ảnh 1.5: Dependency Injection flow từ Program.cs registration đến PageModel injection]**

### 1.4.4. Service Layer Pattern - Tách biệt business logic

Service Layer Pattern tạo một lớp abstraction chứa business logic, tách biệt giữa presentation layer và data access layer. Services encapsulate business rules, validations, calculations và orchestrate calls đến nhiều repositories.

Trong hệ thống BaDongTourismWebsite, mỗi domain entity có một service tương ứng. DestinationService chứa logic liên quan đến destinations như validate destination data, check duplicate names, calculate rating statistics, và orchestrate operations cần nhiều repositories. TourService handle tour-related business logic bao gồm validate tour dates, check capacity, calculate pricing và manage tour destinations relationship.

Service layer giúp keep PageModels thin và focused. PageModels chỉ handle HTTP concerns như model binding, validation attributes và return appropriate responses. Business logic được delegate xuống services, avoiding fat controllers/page models anti-pattern. Điều này giúp code dễ maintain và test hơn.

Services cũng provide reusability. Logic tính toán giá tour có thể được sử dụng ở nhiều nơi: trong booking flow, trong admin panel khi tạo tour mới, trong báo cáo revenue. Thay vì duplicate logic, tất cả đều gọi cùng một method từ service, ensuring consistency.

### 1.4.5. Options Pattern - Quản lý configuration

Options Pattern là cách recommended để access configuration trong ASP.NET Core. Thay vì dùng IConfiguration trực tiếp, define strongly-typed classes để represent configuration sections, và inject IOptions<T> vào services.

Trong dự án, connection string được lưu trong appsettings.json và appsettings.Development.json cho environment-specific configs. Application settings như pagination page size, file upload limits, email configurations có thể được defined trong options classes và bind từ configuration.

Options Pattern mang lại type safety và IntelliSense support khi access config values. Nếu config structure thay đổi, compiler sẽ báo errors thay vì runtime errors. Options cũng support validation, có thể define DataAnnotations trên options classes để validate config values khi application starts.

## 1.5. Bảo mật ứng dụng web

### 1.5.1. Authentication và Authorization

Authentication là quá trình verify identity của user, xác định user là ai. Authorization là quá trình kiểm tra user có quyền access resource cụ thể hay không. Hai concepts này khác biệt nhưng bổ sung cho nhau trong security model.

Hệ thống BaDongTourismWebsite sử dụng cookie-based authentication. Khi user login thành công, một authentication cookie được tạo chứa user claims (ID, email, roles). Cookie này được gửi kèm với mọi subsequent requests, cho phép server identify user mà không cần re-authenticate.

Authentication được configure với các options như cookie expiration time, sliding expiration (extend cookie lifetime on each request), và cookie security settings (HttpOnly, Secure, SameSite). HttpOnly flag ngăn JavaScript access cookie, chống XSS attacks. Secure flag đảm bảo cookie chỉ được gửi qua HTTPS connections. SameSite attribute ngăn CSRF attacks bằng cách restrict cross-site cookie sending.

Authorization được implement thông qua role-based access control (RBAC). Hệ thống định nghĩa bốn roles: Admin, Staff, Customer và Guest. Mỗi role có một set permissions khác nhau. Admin có full access, Staff có quyền manage content nhưng không manage users, Customer có quyền đặt tour và review, Guest chỉ có quyền view public content.

Authorization checks được apply ở multiple levels. Page-level authorization sử dụng Authorize attribute với roles required. Method-level authorization check permissions trong business logic trước khi thực hiện sensitive operations. UI-level authorization ẩn/hiện elements dựa trên user roles.

**[Ghi chú hình ảnh 1.6: Luồng Authentication flow từ login đến cookie generation và authorization check]**

### 1.5.2. Password hashing với BCrypt

Storing passwords dưới dạng plaintext là security vulnerability nghiêm trọng. Nếu database bị breach, attacker có thể access tất cả user accounts. Hashing là quá trình biến đổi password thành một string khác sử dụng one-way function, không thể reverse để lấy lại original password.

BCrypt là một password hashing algorithm được thiết kế specifically cho password storage. Khác với MD5 hoặc SHA algorithms được designed cho speed, BCrypt được designed để slow, making brute-force attacks không practical. BCrypt cũng tự động incorporate salt (random data) vào hash, preventing rainbow table attacks.

Khi user register hoặc change password, plaintext password được hash bằng BCrypt với một work factor (cost). Work factor càng cao, hashing càng lâu, càng khó brute-force. Trong dự án, work factor mặc định được sử dụng, cân bằng giữa security và performance.

Khi user login, plaintext password nhập vào được hash và compare với hash stored trong database. Nếu match, authentication succeed. Quan trọng là không bao giờ log hoặc display hashed passwords, và đảm bảo password validation (length, complexity) được thực hiện trước khi hashing.

### 1.5.3. Cross-Site Scripting (XSS) Prevention

XSS là loại attack trong đó attacker inject malicious JavaScript code vào web pages viewed bởi other users. Code này có thể steal cookies, session tokens, hoặc perform actions on behalf of victim user.

ASP.NET Core Razor Pages có built-in XSS protection thông qua automatic HTML encoding. Khi output user-generated content hoặc data từ database, Razor engine tự động encode special HTML characters như <, >, &, " thành HTML entities (&lt;, &gt;, &amp;, &quot;). Điều này prevent malicious scripts từ việc được executed.

Tuy nhiên, có cases cần output raw HTML (như rich text content). Trong trường hợp này, phải sanitize HTML trước khi output, remove potentially dangerous tags và attributes như <script>, <iframe>, onclick, onerror. Libraries như HtmlSanitizer có thể được sử dụng cho mục đích này.

Content Security Policy (CSP) là một additional defense layer. CSP headers instruct browser chỉ execute scripts từ trusted sources, ngăn inline scripts và eval() function. Trong dự án, CSP có thể được configure để chỉ allow scripts từ same origin và một số trusted CDNs như Bootstrap, jQuery.

### 1.5.4. Cross-Site Request Forgery (CSRF) Protection

CSRF là attack trong đó malicious website tricks user browser into making unwanted requests đến application mà user đã authenticated. Vì browser tự động gửi cookies với requests, malicious site có thể leverage user's authenticated session để perform unauthorized actions.

ASP.NET Core Razor Pages tự động generate và validate antiforgery tokens để prevent CSRF. Mỗi form được rendered với một hidden field chứa antiforgery token. Khi form được submit, server validate token đó match với token stored trong user's session. Nếu không match, request bị reject.

Antiforgery tokens là unique per user session và được regenerate định kỳ. Tokens cũng có expiration time, sau đó không còn valid. Điều này ngăn attacker reuse stolen tokens. Quan trọng là antiforgery validation chỉ apply cho state-changing operations (POST, PUT, DELETE), không apply cho GET requests vì GET should be safe methods.

Ngoài antiforgery tokens, SameSite cookie attribute cũng help prevent CSRF. Setting SameSite=Strict ngăn browser gửi cookies trong cross-site requests, effectively blocking CSRF attacks. Tuy nhiên, strict mode có thể break legitimate cross-site scenarios, nên Lax mode thường được sử dụng làm compromise.

### 1.5.5. SQL Injection Prevention

SQL Injection là attack trong đó attacker inject malicious SQL code vào application input fields, potentially reading, modifying hoặc deleting database data. Đây là một trong những vulnerabilities nguy hiểm nhất trong web applications.

Khi sử dụng Entity Framework Core, application được protected from SQL Injection by default vì EF Core sử dụng parameterized queries. Tất cả LINQ queries được translate thành SQL với parameters thay vì string concatenation, ngăn SQL injection. Ngay cả khi user input chứa SQL keywords, chúng được treated as data parameters, không được executed như SQL code.

Tuy nhiên, vẫn có risks nếu sử dụng raw SQL queries thông qua FromSqlRaw() hoặc ExecuteSqlRaw() methods. Trong trường hợp này, phải ensure sử dụng parameterized queries với placeholders, không concatenate user input trực tiếp vào SQL strings. EF Core provide FromSqlInterpolated() method safely handle parameters trong interpolated strings.

Input validation cũng là important defense layer. Validate user inputs match expected formats (email format, số điện thoại format, date ranges) trước khi process. Reject inputs containing suspicious patterns. Sử dụng allow-lists thay vì deny-lists khi possible, explicitly define allowed characters thay vì try to block dangerous ones.

## 1.6. Tổng kết chương

Chương này đã trình bày các khái niệm lý thuyết nền tảng và công nghệ được sử dụng trong hệ thống BaDongTourismWebsite. ASP.NET Core với Razor Pages được lựa chọn vì tính đơn giản và phù hợp với quy mô dự án. Entity Framework Core cung cấp ORM mạnh mẽ với Change Tracking và Migrations. PostgreSQL được chọn vì chi phí thấp, tính năng phong phú và khả năng mở rộng tốt.

Các design patterns như Repository, Unit of Work, Dependency Injection và Service Layer giúp tổ chức code rõ ràng, dễ maintain và test. Bảo mật được xem xét từ nhiều góc độ bao gồm authentication/authorization, password hashing, XSS prevention, CSRF protection và SQL injection prevention.

Những kiến thức lý thuyết này tạo nền tảng vững chắc cho việc thiết kế và triển khai hệ thống trong các chương tiếp theo. Chương 2 sẽ trình bày chi tiết về phân tích yêu cầu, thiết kế cơ sở dữ liệu và kiến trúc hệ thống cụ thể.

---

# CHƯƠNG 2: PHÂN TÍCH VÀ THIẾT KẾ HỆ THỐNG

## 2.1. Mô tả bài toán

Khu vực Ba Đồng, tỉnh Quảng Bình, là một vùng đất giàu tiềm năng du lịch với nhiều điểm đến thiên nhiên độc đáo, văn hóa bản địa đặc sắc và các tour du lịch đa dạng. Tuy nhiên, hiện trạng quản lý thông tin du lịch tại khu vực này vẫn tồn tại nhiều hạn chế. Thông tin về các điểm đến, tour du lịch và dịch vụ liên quan được phân tán trên nhiều nguồn khác nhau, chủ yếu thông qua các fanpage trên mạng xã hội, trang web cá nhân hoặc truyền miệng. Du khách khó khăn trong việc tìm kiếm thông tin chính xác, so sánh các tour, và đặt chỗ trực tuyến.

Các doanh nghiệp du lịch địa phương thiếu một nền tảng tập trung để quảng bá điểm đến và dịch vụ của mình. Việc quản lý booking thủ công qua điện thoại hoặc tin nhắn dẫn đến nhiều sai sót, trùng lặp đặt chỗ, và khó khăn trong việc theo dõi lịch sử giao dịch. Không có dữ liệu tổng hợp về xu hướng du lịch, các điểm đến được ưa chuộng, hoặc đánh giá của khách hàng, khiến việc cải thiện chất lượng dịch vụ trở nên bị động.

Từ góc độ du khách, họ cần một công cụ để dễ dàng khám phá các điểm đến trong khu vực, xem thông tin chi tiết về tour bao gồm lịch trình và điểm đến, so sánh các lựa chọn dựa trên đánh giá từ người dùng khác, và thực hiện booking trực tuyến một cách thuận tiện. Khả năng xem lịch sử các chuyến đi, lưu trữ thông tin thanh toán, và nhận thông báo về trạng thái booking cũng là những nhu cầu thiết yếu.

Từ góc độ nhà cung cấp dịch vụ (Staff và Admin), họ cần một hệ thống để quản lý thông tin điểm đến và tour một cách có tổ chức, xử lý các booking từ khách hàng, theo dõi trạng thái thanh toán, và có khả năng phân tích dữ liệu để đưa ra quyết định kinh doanh. Hệ thống cũng cần hỗ trợ phân quyền rõ ràng, đảm bảo chỉ người có thẩm quyền mới có thể thực hiện các thao tác nhạy cảm như chỉnh sửa giá tour hoặc xóa dữ liệu.

Bài toán đặt ra là xây dựng một website quản lý và hỗ trợ du lịch Ba Đồng, giải quyết các vấn đề trên bằng cách tạo ra một nền tảng tập trung, dễ sử dụng, và có khả năng mở rộng. Hệ thống cần đáp ứng được yêu cầu về tính chính xác của thông tin, tốc độ xử lý nhanh, bảo mật dữ liệu người dùng, và khả năng hoạt động ổn định với số lượng người dùng đồng thời hợp lý cho quy mô du lịch địa phương.

## 2.2. Yêu cầu chức năng

### 2.2.1. Yêu cầu dành cho khách truy cập (Guest)

Khách truy cập chưa đăng nhập cần có khả năng khám phá thông tin du lịch cơ bản để quyết định có sử dụng dịch vụ hay không. Chức năng xem danh sách điểm đến cho phép browse các địa danh du lịch với thông tin tổng quan bao gồm tên, mô tả ngắn, hình ảnh đại diện và category. Hệ thống cần hỗ trợ filter theo category và pagination để xử lý số lượng destinations lớn.

Chức năng xem chi tiết điểm đến cung cấp thông tin đầy đủ hơn bao gồm mô tả chi tiết, gallery nhiều hình ảnh, location information, và các reviews từ người dùng đã từng đến. Tương tự, guest có thể xem danh sách tour và chi tiết tour bao gồm các điểm đến trong tour, lịch trình ngày, giá cả, và availability.

Để khuyến khích engagement, trang chủ hiển thị các featured destinations và popular tours dựa trên rating và số lượng bookings. Guest cũng có thể truy cập thông tin về accommodations và restaurants trong khu vực, phục vụ cho việc lên kế hoạch chuyến đi toàn diện.

Tuy nhiên, các chức năng quan trọng như đặt tour, viết review, hoặc xem lịch sử cá nhân yêu cầu guest phải đăng ký tài khoản và đăng nhập, tạo động lực chuyển đổi từ anonymous visitor sang registered user.

### 2.2.2. Yêu cầu dành cho khách hàng (Customer)

Sau khi đăng ký và đăng nhập thành công, customer được access toàn bộ chức năng của guest cộng với các tính năng yêu cầu authentication. Chức năng booking tour là trọng tâm, cho phép customer chọn tour, select tour schedule (ngày khởi hành cụ thể), nhập số lượng người tham gia, và cung cấp thông tin liên hệ.

Hệ thống tính toán tổng giá dựa trên giá tour và số lượng người, sau đó tạo booking record với trạng thái Pending. Customer nhận được confirmation với booking ID và thông tin chi tiết. Họ có thể theo dõi trạng thái booking thông qua My Bookings page, nơi hiển thị tất cả bookings với trạng thái hiện tại (Pending, Confirmed, Completed, Cancelled).

Chức năng thanh toán hiện tại chỉ support offline payment methods (cash, bank transfer), với Staff sẽ update payment status manually sau khi nhận được thanh toán. Trong tương lai, integration với payment gateway có thể được thêm vào để support online payment.

Customer có khả năng viết review cho các destinations họ đã từng đến hoặc tours họ đã hoàn thành. Review gồm rating (1-5 stars) và comment text. Hệ thống validate để đảm bảo customer chỉ review cho destinations/tours họ có liên quan (ví dụ: đã complete booking).

Chức năng quản lý profile cho phép customer update thông tin cá nhân như full name, phone number, address, và đổi password. Password cũ cần được verify trước khi allow đổi password mới, và password mới phải thỏa mãn requirements về độ dài và complexity.

**[Ghi chú hình ảnh 2.1: Use case diagram cho Customer actor với các chức năng booking, review, profile management]**

### 2.2.3. Yêu cầu dành cho nhân viên (Staff)

Staff role được design cho các nhân viên vận hành hàng ngày, có quyền quản lý content và xử lý bookings nhưng không có quyền thay đổi cấu trúc hệ thống hoặc quản lý users. Chức năng quản lý điểm đến cho phép Staff tạo mới, chỉnh sửa và xóa destinations, upload multiple images cho mỗi destination, và assign categories.

Khi tạo hoặc chỉnh sửa destination, Staff nhập các thông tin như name, description, address, category selection, và một hoặc nhiều images. Hệ thống validate data (ví dụ: tên không được trống, category phải tồn tại) trước khi lưu. Delete operation cần confirm để tránh xóa nhầm, và hệ thống check foreign key constraints (ví dụ: không xóa được destination đang được dùng trong tour).

Chức năng quản lý tour tương tự, với additional complexity vì mỗi tour liên kết với nhiều destinations và có nhiều schedules. Staff có thể tạo tour mới với thông tin cơ bản (name, description, duration, base price), sau đó add destinations vào tour thông qua many-to-many relationship. Mỗi tour destination có thể có thứ tự cụ thể trong itinerary. Staff cũng tạo tour schedules với start date, end date, available slots, và status.

Chức năng xử lý booking là nhiệm vụ quan trọng nhất của Staff. Họ có thể xem danh sách tất cả bookings với filter theo status, date range, hoặc tour. Khi customer thực hiện payment offline, Staff update booking status từ Pending sang Confirmed và tạo Payment record. Họ cũng có thể cancel bookings với reason note nếu cần.

Staff có quyền moderate reviews, có thể ẩn hoặc xóa các reviews không phù hợp (spam, offensive content). Tuy nhiên, để maintain transparency, việc delete reviews nên được log và require reason.

Dashboard cho Staff hiển thị các metrics quan trọng như số lượng bookings pending cần xử lý, revenue trong tháng hiện tại, top destinations và tours, và recent activities.

### 2.2.4. Yêu cầu dành cho quản trị viên (Admin)

Admin có full access đến tất cả chức năng của Staff cộng với các chức năng quản trị hệ thống cấp cao. Chức năng quản lý users cho phép Admin xem danh sách tất cả users, filter theo role, và thực hiện các operations như create user manually, edit user info, assign/remove roles, và activate/deactivate accounts.

Hệ thống sử dụng role-based authorization với bốn roles được define sẵn: Guest (implicit, không cần record trong database), Customer, Staff, và Admin. Mỗi user có thể có một hoặc nhiều roles thông qua many-to-many relationship trong UserRoles table. Admin có thể assign multiple roles cho một user nếu business logic yêu cầu.

Chức năng quản lý categories cho phép Admin tạo, chỉnh sửa và xóa các destination categories. Vì categories được sử dụng để classify destinations, việc delete category cần check xem có destinations nào đang sử dụng category đó không, và có option để reassign hoặc prevent deletion.

Admin access advanced dashboard với comprehensive analytics bao gồm user growth charts, booking trends over time, revenue reports, most reviewed destinations, và system health metrics. Có thể export reports dưới dạng CSV hoặc PDF cho offline analysis.

Chức năng manage accommodations và restaurants cho phép Admin maintain danh sách các cơ sở lưu trú và nhà hàng đối tác. Information bao gồm name, address, contact, description, pricing range, và images. Customers có thể browse những thông tin này để plan comprehensive trips.

Database seeding và migration tools chỉ available cho Admin. Seed data bao gồm default roles, sample categories, initial destinations, tours, và demo users cho testing purposes. Admin có thể trigger re-seed nếu cần reset database về initial state trong development environment.

**[Ghi chú hình ảnh 2.2: Use case diagram cho Staff và Admin actors với phân cấp quyền hạn rõ ràng]**

## 2.3. Thiết kế cơ sở dữ liệu

### 2.3.1. Tổng quan về cấu trúc database

Cơ sở dữ liệu được thiết kế theo relational model với 14 tables chính, reflect domain entities và relationships trong hệ thống du lịch. Schema được normalize đến third normal form (3NF) để giảm data redundancy và maintain data integrity, nhưng có một số denormalization có chủ ý cho performance optimization.

Database sử dụng PostgreSQL 16 làm RDBMS, leverage các tính năng advanced như JSONB for semi-structured data, GIN indexes for full-text search, và partial indexes for query optimization. Naming convention tuân theo PascalCase cho table names và column names, consistent với C# naming trong code.

Primary keys đều sử dụng INT identity columns với auto-increment, providing simple và efficient unique identifiers. Foreign keys được define với appropriate ON DELETE behaviors (CASCADE cho dependent entities, RESTRICT cho referenced entities cần preserve).

### 2.3.2. Nhóm tables Authentication và Authorization

**Users table** là core của authentication system, chứa user account information. Các columns chính bao gồm:

- UserId (INT, PK): Unique identifier
- Email (VARCHAR(100), UNIQUE, NOT NULL): Dùng làm username cho login
- PasswordHash (VARCHAR(255), NOT NULL): BCrypt hashed password
- FullName (VARCHAR(100), NOT NULL): Display name
- Phone (VARCHAR(20), NULL): Optional contact number
- Address (VARCHAR(255), NULL): Optional address
- IsActive (BIT, DEFAULT 1): Flag để deactivate accounts
- CreatedAt (DATETIME, DEFAULT GETDATE()): Audit timestamp

Email phải unique để ensure mỗi email chỉ có một account. Index trên Email column để optimize login queries. PasswordHash không bao giờ được log hoặc return trong API responses.

**Roles table** define các roles trong hệ thống:

- RoleId (INT, PK)
- RoleName (VARCHAR(50), UNIQUE, NOT NULL): Admin, Staff, Customer
- Description (VARCHAR(255), NULL): Mô tả quyền hạn của role

Roles được seed sẵn và ít khi thay đổi. RoleName có unique constraint để prevent duplicate roles.

**UserRoles table** là junction table implement many-to-many relationship giữa Users và Roles:

- UserRoleId (INT, PK)
- UserId (INT, FK to Users, NOT NULL)
- RoleId (INT, FK to Roles, NOT NULL)
- AssignedAt (DATETIME, DEFAULT GETDATE())

Composite unique index trên (UserId, RoleId) prevent duplicate role assignments. Khi User bị delete (nếu business logic allow), corresponding UserRoles records cascade delete.

**[Ghi chú hình ảnh 2.3: Entity Relationship Diagram cho nhóm tables Authentication - Users, Roles, UserRoles]**

### 2.3.3. Nhóm tables Tourism Content

**Categories table** classify destinations:

- CategoryId (INT, PK)
- CategoryName (VARCHAR(100), UNIQUE, NOT NULL)
- Description (VARCHAR(500), NULL)
- Icon (VARCHAR(50), NULL): CSS class or image path cho display
- CreatedAt (DATETIME)

Categories như "Danh lam thắng cảnh", "Di tích lịch sử", "Sinh thái tự nhiên", "Văn hóa bản địa" giúp users filter destinations easily.

**Destinations table** là centerpiece của tourism content:

- DestinationId (INT, PK)
- Name (VARCHAR(200), NOT NULL)
- Description (NTEXT, NULL): Rich text mô tả chi tiết
- Address (VARCHAR(255), NULL)
- CategoryId (INT, FK to Categories, NOT NULL)
- Latitude (DECIMAL(10,7), NULL): Coordinates cho map integration
- Longitude (DECIMAL(10,7), NULL)
- IsFeatured (BIT, DEFAULT 0): Flag để highlight trên homepage
- AverageRating (DECIMAL(3,2), DEFAULT 0): Cached average từ Reviews
- ViewCount (INT, DEFAULT 0): Tracking popularity
- CreatedAt (DATETIME)
- UpdatedAt (DATETIME)

AverageRating là denormalized field, recalculated khi có review mới to avoid expensive aggregation queries mỗi lần display destination list. Index trên CategoryId và IsFeatured optimize common queries.

**DestinationImages table** support multiple images per destination:

- ImageId (INT, PK)
- DestinationId (INT, FK to Destinations, NOT NULL, ON DELETE CASCADE)
- ImagePath (VARCHAR(500), NOT NULL): Relative path to image file
- Caption (VARCHAR(255), NULL)
- IsPrimary (BIT, DEFAULT 0): Main image cho thumbnail
- DisplayOrder (INT, DEFAULT 0): Order trong gallery
- UploadedAt (DATETIME)

Mỗi Destination có thể có nhiều images, nhưng chỉ một image có IsPrimary=1. Khi delete destination, tất cả images cascade delete, và files trên disk cũng cần được cleanup thông qua application logic.

**[Ghi chú hình ảnh 2.4: ER Diagram cho Tourism Content - Categories, Destinations, DestinationImages với relationships]**

### 2.3.4. Nhóm tables Tour Management

**Tours table** represent các tour packages:

- TourId (INT, PK)
- Name (VARCHAR(200), NOT NULL)
- Description (NTEXT, NULL)
- DurationDays (INT, NOT NULL): Số ngày của tour
- BasePrice (DECIMAL(18,2), NOT NULL): Giá cơ bản per person
- MaxParticipants (INT, NOT NULL): Capacity limit
- Inclusions (NTEXT, NULL): What's included (meals, transport)
- Exclusions (NTEXT, NULL): What's not included
- TermsAndConditions (NTEXT, NULL)
- IsActive (BIT, DEFAULT 1)
- CreatedAt (DATETIME)
- UpdatedAt (DATETIME)

BasePrice là starting price, actual price có thể vary based on schedule hoặc group size, nhưng phiên bản hiện tại sử dụng fixed pricing để simplify.

**TourDestinations table** là junction table với additional attributes:

- TourDestinationId (INT, PK)
- TourId (INT, FK to Tours, NOT NULL, ON DELETE CASCADE)
- DestinationId (INT, FK to Destinations, NOT NULL, ON DELETE RESTRICT)
- DayNumber (INT, NOT NULL): Ngày thứ mấy trong itinerary
- VisitDuration (VARCHAR(50), NULL): "2 hours", "Full day"
- Activities (VARCHAR(500), NULL): Planned activities tại destination
- DisplayOrder (INT, DEFAULT 0)

Composite index trên (TourId, DayNumber) để efficiently retrieve itinerary theo thứ tự. ON DELETE RESTRICT cho DestinationId prevent deleting destinations đang used in active tours.

**TourSchedules table** manage các departure dates của tours:

- ScheduleId (INT, PK)
- TourId (INT, FK to Tours, NOT NULL, ON DELETE CASCADE)
- StartDate (DATE, NOT NULL)
- EndDate (DATE, NOT NULL): Calculated from StartDate + DurationDays
- AvailableSlots (INT, NOT NULL): Initially = MaxParticipants
- Status (VARCHAR(20), DEFAULT 'Active'): Active, Full, Cancelled
- CreatedAt (DATETIME)

AvailableSlots decrement khi có booking confirmed, ensuring không overbook. Status tự động update sang Full khi AvailableSlots = 0. Unique constraint trên (TourId, StartDate) prevent duplicate schedules.

**[Ghi chú hình ảnh 2.5: ER Diagram cho Tour Management - Tours, TourDestinations, TourSchedules]**

### 2.3.5. Nhóm tables Booking và Payment

**Bookings table** track customer tour bookings:

- BookingId (INT, PK)
- UserId (INT, FK to Users, NOT NULL, ON DELETE RESTRICT)
- ScheduleId (INT, FK to TourSchedules, NOT NULL, ON DELETE RESTRICT)
- NumberOfParticipants (INT, NOT NULL)
- TotalPrice (DECIMAL(18,2), NOT NULL): Snapshot of price at booking time
- Status (VARCHAR(20), DEFAULT 'Pending'): Pending, Confirmed, Completed, Cancelled
- BookingDate (DATETIME, DEFAULT GETDATE())
- ConfirmedAt (DATETIME, NULL)
- CancelledAt (DATETIME, NULL)
- CancellationReason (VARCHAR(500), NULL)
- CustomerName (VARCHAR(100), NOT NULL): Snapshot cho audit
- CustomerPhone (VARCHAR(20), NOT NULL)
- CustomerEmail (VARCHAR(100), NOT NULL)
- Notes (VARCHAR(500), NULL)

TotalPrice là calculated field lưu snapshot để preserve giá tại thời điểm booking, even if tour price thay đổi sau đó. Customer contact info được duplicate từ Users table để có snapshot nếu user update profile.

Indexes trên UserId, ScheduleId, và Status optimize common queries như "my bookings", "bookings for a schedule", "pending bookings".

**Payments table** track payment transactions:

- PaymentId (INT, PK)
- BookingId (INT, FK to Bookings, NOT NULL, ON DELETE RESTRICT)
- Amount (DECIMAL(18,2), NOT NULL)
- PaymentMethod (VARCHAR(50), NOT NULL): Cash, Bank Transfer, Online
- PaymentStatus (VARCHAR(20), DEFAULT 'Pending'): Pending, Completed, Failed, Refunded
- TransactionId (VARCHAR(100), NULL): External transaction reference
- PaymentDate (DATETIME, NULL): Actual payment completion time
- CreatedAt (DATETIME, DEFAULT GETDATE())
- Notes (VARCHAR(500), NULL)

Mỗi Booking có thể có multiple Payment records nếu support partial payments hoặc refunds, nhưng typically one-to-one. PaymentStatus track riêng vì có thể booking Confirmed nhưng payment vẫn Pending (credit terms).

### 2.3.6. Nhóm tables Social và Supporting

**Reviews table** cho phép customers rate và comment:

- ReviewId (INT, PK)
- DestinationId (INT, FK to Destinations, NULL, ON DELETE CASCADE)
- TourId (INT, FK to Tours, NULL, ON DELETE CASCADE)
- UserId (INT, FK to Users, NOT NULL, ON DELETE RESTRICT)
- Rating (INT, NOT NULL, CHECK (Rating BETWEEN 1 AND 5))
- Comment (NTEXT, NULL)
- IsApproved (BIT, DEFAULT 1): Moderation flag
- CreatedAt (DATETIME, DEFAULT GETDATE())
- UpdatedAt (DATETIME, NULL)

Một review có thể cho Destination hoặc Tour (XOR constraint: chỉ một trong hai foreign keys được populate). Check constraint ensure Rating trong range 1-5. Composite index trên (DestinationId, IsApproved) và (TourId, IsApproved) optimize public review displays.

**Accommodations table** provide lodging information:

- AccommodationId (INT, PK)
- Name (VARCHAR(200), NOT NULL)
- Address (VARCHAR(255), NULL)
- Description (NTEXT, NULL)
- Phone (VARCHAR(20), NULL)
- Email (VARCHAR(100), NULL)
- Website (VARCHAR(255), NULL)
- PriceRange (VARCHAR(50), NULL): "$", "$$", "$$$"
- Rating (DECIMAL(3,2), NULL)
- ImagePath (VARCHAR(500), NULL)
- CreatedAt (DATETIME)

**Restaurants table** tương tự structure với Accommodations:

- RestaurantId (INT, PK)
- Name (VARCHAR(200), NOT NULL)
- Address (VARCHAR(255), NULL)
- Description (NTEXT, NULL)
- Cuisine (VARCHAR(100), NULL): Vietnamese, Seafood, etc.
- Phone (VARCHAR(20), NULL)
- PriceRange (VARCHAR(50), NULL)
- Rating (DECIMAL(3,2), NULL)
- ImagePath (VARCHAR(500), NULL)
- CreatedAt (DATETIME)

Accommodations và Restaurants không integrate deeply với booking flow hiện tại, mainly informational. Future enhancements có thể add booking integration hoặc affiliate links.

**[Ghi chú hình ảnh 2.6: Complete Entity Relationship Diagram tổng hợp 14 tables với tất cả relationships và cardinalities]**

## 2.4. Thiết kế kiến trúc hệ thống

### 2.4.1. Tổng quan kiến trúc tổng thể

Hệ thống BaDongTourismWebsite được thiết kế theo layered architecture pattern với bốn layers chính: Presentation Layer, Business Logic Layer (BLL), Data Access Layer (DAL), và Database Layer. Kiến trúc này provide clear separation of concerns, making code dễ maintain, test, và scale.

Presentation Layer chứa Razor Pages (CSHTML files và PageModel classes), handle HTTP requests/responses, model binding, validation attributes, và rendering views. PageModels act như controllers trong MVC pattern, nhưng page-focused thay vì controller-focused. Razor syntax allow embedding C# code trong HTML templates với automatic HTML encoding for XSS protection.

Business Logic Layer chứa domain services implement business rules và validations. Các services như DestinationService, TourService, BookingService encapsulate complex logic như calculating tour prices, checking booking availability, updating destination ratings. Services coordinate multiple repository calls và ensure business rules được enforced consistently.

Data Access Layer được implement qua Repository Pattern và Unit of Work Pattern. Mỗi entity có một repository interface định nghĩa data operations, với concrete implementation sử dụng EF Core. IUnitOfWork interface coordinate repositories và manage transaction boundaries thông qua DbContext.

Database Layer là PostgreSQL database với schema được describe ở section 2.3. Application connect qua Npgsql provider, EF Core translate LINQ queries thành SQL commands, và manage connection pooling automatically.

Cross-cutting concerns như logging, authentication, và error handling được implement qua middleware pipeline trong ASP.NET Core. Middleware components process requests trước khi reach PageModels và process responses sau khi PageModels complete.

**[Ghi chú hình ảnh 2.7: Layered architecture diagram với 4 layers và dependencies flow từ top down]**

### 2.4.2. Presentation Layer - Razor Pages

Razor Pages được organize theo feature folders, mỗi main entity có một folder riêng. Ví dụ: Pages/Destinations chứa Index.cshtml (list view), Details.cshtml (detail view), Create.cshtml, Edit.cshtml, và Delete.cshtml cùng với corresponding PageModel classes.

PageModel classes inherit từ PageModel base class, có access đến HttpContext, ModelState, TempData, và dependency-injected services. Constructor injection được sử dụng để inject services như IDestinationService vào PageModels. Điều này follow Dependency Inversion Principle, PageModels depend on abstractions (interfaces) thay vì concrete classes.

OnGet() methods handle GET requests, typically load data từ services và return Page(). OnPost() methods handle form submissions, validate input using ModelState, call services để perform actions, và redirect hoặc return Page() với errors. RedirectToPage() được sử dụng post-redirect-get pattern để prevent duplicate submissions.

ViewData và TempData được sử dụng để pass data giữa PageModel và view, hoặc giữa các redirects. ViewData lifetime limited đến current request, TempData persists across one redirect. Strongly-typed PageModel properties with [BindProperty] attribute provide cleaner alternative cho simple scenarios.

Partial views (\_PartialViewName.cshtml) được sử dụng để reuse UI components như destination cards, review listings, pagination controls. Layout pages (\_Layout.cshtml) define common structure với navigation, footer, và render body content từ individual pages.

Tag Helpers simplify generating HTML với server-side logic. Ví dụ: `<a asp-page="Details" asp-route-id="@destination.DestinationId">` generates correct href với routing parameters. Form Tag Helpers tự động add antiforgery tokens và bind model properties.

### 2.4.3. Business Logic Layer - Services

Service classes implement business logic separated từ data access và presentation concerns. Mỗi service focus vào một domain area. DestinationService handle destination-related operations như GetAllDestinations, GetDestinationById, CreateDestination, UpdateDestination, DeleteDestination, GetFeaturedDestinations, UpdateViewCount, RecalculateAverageRating.

Services inject IUnitOfWork dependency để access repositories. Ví dụ: DestinationService có \_unitOfWork field, call \_unitOfWork.Destinations để get destination repository, \_unitOfWork.Reviews để get reviews, và \_unitOfWork.SaveChangesAsync() để commit transaction.

Business rules được enforce trong services. Khi create destination, service validate tên không trống, category exists, và images meet requirements. Khi delete destination, service check xem có tours nào reference destination này không, nếu có thì throw exception hoặc return error result.

Calculating tour pricing là responsibility của TourService. BasePrice từ Tours table được multiply với NumberOfParticipants để get TotalPrice. Nếu có discounts (future feature), logic được centralize trong service. Khi booking được created, TourService also update AvailableSlots trong TourSchedules.

BookingService orchestrate booking workflow: validate schedule has available slots, calculate total price, create Booking record, decrement available slots, send confirmation (placeholder). Nếu any step fails, transaction rollback ensuring data consistency.

Services return DTOs (Data Transfer Objects) thay vì raw entities trong một số cases để control exactly what data exposed đến presentation layer và avoid over-fetching. DTOs cũng decouple presentation từ database schema, allowing schema changes không break API contracts.

Error handling trong services sử dụng exceptions cho exceptional cases (database connection failures) và return Result<T> objects cho business rule violations (booking full, invalid input). Result pattern provide richer information than throwing exceptions for expected failures.

**[Ghi chú hình ảnh 2.8: Sequence diagram cho booking flow từ PageModel qua BookingService đến multiple repositories]**

### 2.4.4. Data Access Layer - Repositories

Repository Pattern abstract data access logic behind interfaces. IDestinationRepository define methods như:

```csharp
Task<IEnumerable<Destination>> GetAllAsync();
Task<Destination> GetByIdAsync(int id);
Task<Destination> GetByIdWithImagesAsync(int id);
Task<IEnumerable<Destination>> GetFeaturedAsync();
Task<IEnumerable<Destination>> GetByCategoryAsync(int categoryId);
Task AddAsync(Destination destination);
Task UpdateAsync(Destination destination);
Task DeleteAsync(int id);
```

Concrete DestinationRepository class implement interface, sử dụng ApplicationDbContext (EF Core DbContext). Methods use DbSet<Destination> để query và modify data. GetByIdWithImagesAsync sử dụng Include() để eager load DestinationImages, avoiding N+1 query problems.

AsNoTracking() được sử dụng cho read-only queries to improve performance. EF Core change tracking có overhead tracking entity states for updates. Khi chỉ cần read data without modifying, AsNoTracking() skip tracking mechanism.

Generic Repository Pattern có thể được implement với IRepository<T> interface defining common CRUD operations, và concrete GenericRepository<T> class implement chúng. Specific repositories như DestinationRepository inherit từ GenericRepository<Destination> và add specialized methods như GetFeaturedAsync().

IUnitOfWork interface coordinate repositories:

```csharp
public interface IUnitOfWork : IDisposable {
    IDestinationRepository Destinations { get; }
    ITourRepository Tours { get; }
    IBookingRepository Bookings { get; }
    // ... other repositories
    Task<int> SaveChangesAsync();
}
```

UnitOfWork class maintain một DbContext instance và lazy-initialize repositories. SaveChangesAsync() delegate đến DbContext.SaveChangesAsync(), ensuring tất cả changes across repositories được commit trong một transaction.

Benefits của Repository và Unit of Work Patterns: testability (mock repositories trong unit tests), centralization of data access logic, loose coupling between BLL và specific ORM, và ability to switch data source without changing business logic.

### 2.4.5. Configuration và Dependency Injection

ASP.NET Core's built-in DI container được configure trong Program.cs. Services được register với appropriate lifetimes:

**Scoped lifetime:** Một instance per HTTP request. DbContext, repositories, và business services đều registered như Scoped vì they should không shared across requests để avoid threading issues. Mỗi request get fresh DbContext instance với isolated change tracking.

**Transient lifetime:** Một instance mỗi lần inject. Được sử dụng cho lightweight stateless services có minimal overhead creating new instances.

**Singleton lifetime:** Một instance cho entire application lifetime. Được sử dụng cho expensive-to-create services hoặc services cần maintain state across requests (caching, configuration). Phải thread-safe nếu accessed by multiple requests simultaneously.

Configuration được load từ appsettings.json và environment-specific files (appsettings.Development.json, appsettings.Production.json). Connection strings, logging levels, và application-specific settings được define here. IConfiguration interface được inject vào services cần access configuration.

Options Pattern provide strongly-typed access đến configuration. Define a class like AppSettings với properties matching JSON structure, call services.Configure<AppSettings>() trong Program.cs, và inject IOptions<AppSettings> vào services. Compiler type-checking ensures configuration properties spelled correctly.

Middleware pipeline được configure trong Program.cs với app.Use\* methods. Order matters: UseRouting() before UseAuthentication() và UseAuthorization(), UseStaticFiles() early để serve files without hitting authentication, UseExceptionHandler() first để catch all exceptions.

### 2.4.6. Bảo mật trong kiến trúc

Authentication middleware verify identity based on authentication cookie. Khi user login successfully, ClaimsPrincipal được created chứa user claims (ID, email, roles), và authentication cookie được issued. Subsequent requests automatically deserialize cookie thành ClaimsPrincipal available trong HttpContext.User.

Authorization middleware check permissions based on roles. Authorize attribute ở page level hoặc method level specify required roles. Ví dụ: [Authorize(Roles = "Admin,Staff")] chỉ allow Admin hoặc Staff access. Authorization policy có thể define complex requirements combine roles, claims, và custom logic.

Password hashing với BCrypt happen trong services layer trước khi save Users. Plaintext passwords không bao giờ stored hoặc logged. Verification during login hash submitted password và compare với stored hash, không reverse hash.

Antiforgery tokens generated automatically cho forms trong Razor Pages. Hidden field \_\_RequestVerificationToken embedded trong forms, validated on POST requests. Attackers không thể forge valid tokens từ external sites.

Input validation ở multiple layers: client-side với HTML5 validation attributes và JavaScript, model-level với DataAnnotations, service-level với business rule checks. Never trust client-side validation alone vì có thể bypassed.

Logging và auditing track important events như login attempts, booking creations, payment processing, admin actions. Sensitive data (passwords, full credit card numbers) không log. Audit logs help detect suspicious activities và troubleshoot issues.

**[Ghi chú hình ảnh 2.9: Security architecture diagram với authentication/authorization flow và multiple validation layers]**

## 2.5. Tổng kết chương

Chương này đã trình bày phân tích chi tiết về bài toán quản lý du lịch Ba Đồng và cách hệ thống được thiết kế để giải quyết bài toán đó. Yêu cầu chức năng được phân tích theo từng actor (Guest, Customer, Staff, Admin), mỗi role có permissions và responsibilities rõ ràng.

Thiết kế cơ sở dữ liệu với 14 tables cover đầy đủ các domain entities và relationships. Schema được normalize appropriately nhưng có denormalization có chủ ý (AverageRating, snapshot fields) cho performance. Foreign keys và constraints ensure data integrity.

Kiến trúc hệ thống theo layered pattern với clear separation of concerns. Presentation Layer handle user interactions, BLL chứa business logic, DAL abstract data access, và Database Layer store persistent data. Design patterns như Repository, Unit of Work, và Dependency Injection promote code quality và testability.

Security được integrated throughout architecture với authentication, authorization, password hashing, CSRF protection, và input validation ở multiple layers. Configuration management và dependency injection make system flexible và maintainable.

Chương 3 sẽ present kết quả implement dựa trên thiết kế này, demonstrate các chức năng hoạt động qua screenshots và mô tả testing procedures.

---

# CHƯƠNG 3: KẾT QUẢ TRIỂN KHAI

Chương này trình bày kết quả triển khai hệ thống BaDongTourismWebsite dựa trên thiết kế ở Chương 2. Nội dung tập trung vào các chức năng đã được implement với workflow cụ thể và giao diện người dùng. Các chức năng được minh họa thông qua hình ảnh screenshots từ hệ thống thực tế đang chạy.

## 3.1. Môi trường triển khai

Hệ thống được phát triển trên môi trường Windows/macOS với JetBrains Rider IDE, .NET SDK 9.0, PostgreSQL 16 chạy trong Docker container. Database được khởi tạo thông qua EF Core Migrations với đầy đủ 14 tables như thiết kế. Seed data bao gồm admin account, categories, và một số destinations mẫu được tạo tự động khi chạy migration lần đầu.

**[Hình 3.1: Cấu trúc project trong Solution Explorer với folders: Pages (Admin, Auth, Destinations, Shared), Data (Models, DbContext), Services, wwwroot (css, js, images)]**

**[Hình 3.2: PostgreSQL database trong pgAdmin hiển thị 14 tables: Users, Roles, UserRoles, Categories, Destinations, DestinationImages, Tours, TourDestinations, TourSchedules, Bookings, Payments, Reviews, Accommodations, Restaurants]**

## 3.2. Chức năng người dùng chung

### 3.2.1. Trang chủ (Homepage)

Trang chủ là điểm tiếp xúc đầu tiên của người dùng với hệ thống. Hero section chiếm toàn bộ viewport với background image Ba Đồng, heading "Khám Phá Vẻ Đẹp Ba Đồng", subtitle mô tả ngắn, và search bar cho phép tìm kiếm destinations.

**[Hình 3.3: Hero section full-width với background image, heading overlay, search bar với icon search, navigation bar ở top có logo và menu items (Trang Chủ, Điểm Đến, Đăng Nhập, Đăng Ký)]**

Phía dưới hero là services section với 4 icons: Điểm Du Lịch, Tours Đa Dạng, Lưu Trú, Ẩm Thực. Section "Điểm Đến Nổi Bật" hiển thị featured destinations trong grid 3 cột với destination cards có image, category badge, tên, location, rating và nút "Xem Chi Tiết".

**[Hình 3.4: Featured Destinations section với 3 destination cards trong một row, mỗi card có: image 250px height, badge góc trên "Nổi bật", tên destination bold, location với icon pin, rating stars màu vàng, nút "Xem chi tiết"]**

### 3.2.2. Danh sách điểm đến

Trang Destinations hiển thị toàn bộ destinations trong hệ thống. Top của page có heading "Điểm Du Lịch" bên trái và search box bên phải. Grid destinations xếp 3 cột với layout responsive. Mỗi destination card hiển thị main image, tên, location, short description, rating và action button.

**[Hình 3.5: Destinations Index page với search bar ở top-right, grid 3 cột destinations, mỗi card có đầy đủ info, pagination ở bottom nếu có nhiều hơn 12 items]**

Khi search với keyword, alert box xuất hiện phía trên grid hiển thị "Kết quả tìm kiếm cho: {keyword}". Results được filter theo tên hoặc description chứa keyword.

**[Hình 3.6: Search results page với alert info box "Kết quả tìm kiếm cho: động phong nha", grid chỉ hiển thị matching destinations]**

### 3.2.3. Chi tiết điểm đến

Details page mở khi click vào destination card. Breadcrumb navigation ở top: Trang chủ > Điểm du lịch > {Tên destination}. Main content trong card có main image large (400px height), tên destination h1, location với icon, rating với stars và view count.

**[Hình 3.7: Destination Details page với main image full-width của card, breadcrumb navigation ở top, thông tin cơ bản gồm tên, location, rating 4.5/5, view count 120, badge "Nổi bật" nếu IsFeatured=true]**

Phía dưới là description section với full text mô tả chi tiết. Nếu có multiple images, gallery section hiển thị thumbnails trong grid 3 cột, 2 rows (6 images). Reviews section ở bottom hiển thị existing reviews nếu có, mỗi review có reviewer name, date, stars và comment.

**[Hình 3.8: Description section với paragraphs, gallery section với 6 thumbnails grid (3 cols x 2 rows), mỗi thumbnail 200px height, rounded corners]**

**[Hình 3.9: Reviews section với 2-3 review items, mỗi item có: avatar placeholder circle, reviewer name bold, date text-muted, 5 stars với fill màu vàng theo rating, comment text]**

## 3.3. Chức năng authentication

### 3.3.1. Đăng ký tài khoản

Register page centered với form card có heading "Đăng ký" và icon user-plus. Form có các fields: Full Name, Email, Phone Number (optional), Password, Confirm Password. Mỗi field sử dụng floating labels với icons. Submit button "Đăng ký" ở bottom, footer có link "Đã có tài khoản? Đăng nhập".

**[Hình 3.10: Register page với centered form card (~500px width), fields với floating labels, icons bên trái (user, envelope, phone, lock), submit button full-width primary, footer links]**

Khi validation fail (password không khớp, email đã tồn tại), error messages hiển thị dưới corresponding fields với màu đỏ. Alert box đỏ xuất hiện ở top của form nếu có model-level errors.

**[Hình 3.11: Register form với validation errors: Confirm Password field có border đỏ và error text "Mật khẩu xác nhận không khớp" màu đỏ bên dưới]**

Đăng ký thành công redirect về homepage với user đã logged in. Navbar update hiển thị user name thay vì "Đăng Nhập/Đăng Ký" buttons.

**[Hình 3.12: Homepage sau register success, navbar right side hiển thị user dropdown với avatar circle và name "Nguyễn Văn A", dropdown menu có items "Hồ Sơ", "Đơn Đặt Tour", divider, "Đăng Xuất"]**

### 3.3.2. Đăng nhập

Login page tương tự layout với Register nhưng chỉ có 2 fields: Email và Password. Có checkbox "Ghi nhớ đăng nhập" và link "Quên mật khẩu?" phía dưới. Footer có link đến register page.

**[Hình 3.13: Login page với form card centered, 2 fields (Email, Password), checkbox Remember Me, link "Quên mật khẩu?", submit button, footer link "Chưa có tài khoản? Đăng ký ngay"]**

Login failed với wrong credentials hiển thị alert danger ở top form: "Email hoặc mật khẩu không đúng" với icon warning.

**[Hình 3.14: Login form với alert danger box ở top màu đỏ nhạt, text "Email hoặc mật khẩu không đúng", icon exclamation-circle]**

Login success với Admin role redirect đến Admin Dashboard thay vì homepage. Navbar và layout hoàn toàn khác với user interface.

**[Hình 3.15: Admin Dashboard sau login, sidebar menu bên trái với logo top, menu items (Dashboard active, Destinations, Tours, Users, Settings), main content area bên phải chiếm 80% width]**

## 3.4. Chức năng Admin

### 3.4.1. Admin Dashboard

Dashboard hiển thị overview thống kê hệ thống. Top section có 4 statistic cards trong row: Total Destinations, Total Tours, Total Users, Total Bookings. Mỗi card có icon lớn, số liệu lớn bold, label description.

**[Hình 3.16: Dashboard statistic cards grid 4 cột, mỗi card có: icon 3x size màu primary (map-marked-alt, route, users, bookmark), số liệu h3 (10, 5, 25, 8), label text-muted]**

Phía dưới là 2 sections side-by-side: "Điểm du lịch nổi bật" table bên trái và "Tours phổ biến" table bên phải. Mỗi section có heading và link "Xem tất cả". Tables hiển thị top 5 items với basic info.

**[Hình 3.17: Dashboard bottom section với 2 tables (50% width each): Featured Destinations table (columns: Tên, Đánh giá, Trạng thái) và Popular Tours table (columns: Tên, Giá, Ngày khởi hành)]**

### 3.4.2. Quản lý điểm đến

Admin Destinations Index page với heading "Quản lý Điểm Du Lịch" và nút "Thêm mới" button primary có icon plus ở top-right. Success message alert xuất hiện sau create/update/delete actions.

**[Hình 3.18: Admin Destinations Index với heading left, button "Thêm mới" right, alert success "Thêm điểm du lịch thành công!" màu xanh với icon check, auto-dismiss sau 3s]**

Table hiển thị list destinations với columns: ID, Tên, Địa điểm, Loại, Đánh giá, Trạng thái, Thao tác. Trạng thái hiển thị badges: "Hoạt động" màu xanh, "Không hoạt động" màu xám. Tên destination có badge "Nổi bật" màu vàng nếu IsFeatured.

**[Hình 3.19: Destinations management table với 5-6 rows, column Tên có text bold và badge "Nổi bật", column Trạng thái có badge pills, column Thao tác có button group với 2 buttons: Edit (outline-primary icon edit), Delete (outline-danger icon trash)]**

Empty state khi chưa có destinations: centered message "Chưa có điểm du lịch nào. Click 'Thêm mới' để tạo điểm đến đầu tiên."

**[Hình 3.20: Empty state với icon folder-open gray 4x, text "Chưa có điểm du lịch nào", button "Thêm mới" primary centered below]**

### 3.4.3. Thêm điểm đến mới

Create page có heading "Thêm Điểm Du Lịch Mới" và button "Quay lại" outline. Form layout 2 columns: left column 8/12 width có main fields (Tên, Mô tả ngắn, Mô tả chi tiết, Location, Province, Category, Rating, Main Image URL), right column 4/12 có preview section hoặc additional options.

**[Hình 3.21: Create Destination form với layout 2 columns, left column có fields stacked vertical, right column có card "Preview" hoặc "Hướng dẫn", submit button "Lưu" primary và "Hủy" secondary ở bottom left column]**

Form fields sử dụng standard Bootstrap form controls. Required fields có asterisk (\*) màu đỏ trong label. Textarea cho Description có rows=6. Select cho Category hiển thị list categories từ database. Number input cho Rating có min=0, max=5, step=0.1.

**[Hình 3.22: Form fields detail: Label "Tên điểm du lịch *" với asterisk đỏ, input text full-width, Label "Mô tả chi tiết *", textarea rows=6, Label "Loại *", select dropdown với options, Label "Đánh giá (0-5)", number input với spinner controls]**

Validation errors hiển thị dưới fields với màu đỏ khi submit failed. Model validation summary ở top form trong alert danger nếu có multiple errors.

**[Hình 3.23: Create form with validation errors, alert danger box ở top "Vui lòng kiểm tra các trường bên dưới", Name field có border đỏ và error text "Tên không được để trống", Category field có error "Vui lòng chọn loại"]**

### 3.4.4. Chỉnh sửa điểm đến

Edit page tương tự Create nhưng form pre-populated với destination data hiện tại. Heading "Chỉnh Sửa Điểm Du Lịch" và breadcrumb hoặc back button. Main image preview hiển thị current image nếu có.

**[Hình 3.24: Edit Destination form với fields pre-filled, Main Image URL field có current URL, preview image 200px width hiển thị bên dưới hoặc right column, submit button "Cập nhật"]**

Save success redirect về Index với success message. Cancel button hoặc back link return về Index không save changes.

**[Hình 3.25: Index page sau edit success, alert success "Cập nhật điểm du lịch thành công!", destination updated row có subtle highlight background fade animation]**

### 3.4.5. Xóa điểm đến

Delete page hiển thị confirmation với destination details readonly. Heading "Xác Nhận Xóa" màu danger. Warning alert "Bạn có chắc chắn muốn xóa điểm du lịch này? Hành động này không thể hoàn tác."

**[Hình 3.26: Delete Destination confirmation page với heading danger, alert warning box màu vàng nhạt với icon exclamation-triangle, destination info displayed readonly (Tên, Location, Category), form buttons: "Xóa" danger và "Hủy" secondary]**

Delete success redirect về Index với success message. Nếu destination đang được reference bởi tours (foreign key constraint), error message hiển thị: "Không thể xóa điểm đến này vì đang được sử dụng trong tours."

**[Hình 3.27: Index page sau delete failed, alert danger "Không thể xóa điểm đến này vì đang được sử dụng trong tours", destination row vẫn còn trong table]**

## 3.5. Đánh giá hệ thống

### 3.5.1. Giao diện responsive

Hệ thống sử dụng Bootstrap 5 responsive grid system. Layout tự động adjust cho mobile, tablet, và desktop. Navigation bar collapse thành hamburger menu trên mobile. Destination cards stack 1 column trên mobile, 2 columns trên tablet, 3 columns trên desktop.

**[Hình 3.28: Side-by-side comparison: Desktop view (3 columns) và Mobile view (1 column stacked), hamburger menu icon top-right trên mobile, navigation drawer slide từ left]**

### 3.5.2. Testing results

Hệ thống đã được test các chức năng chính: User registration/login, Browse destinations, Search destinations, Admin CRUD destinations. Tất cả test cases passed với expected results. Database constraints (foreign keys, unique constraints) hoạt động đúng.

**[Hình 3.29: Test results summary table: Test Case, Status (Pass/Fail), Notes. 10 test cases listed, tất cả có status badge "Pass" màu xanh]**

### 3.5.3. Performance metrics

Application load time trên localhost trung bình 200-300ms cho homepage, 150-250ms cho destinations list. Database queries optimized với EF Core include để avoid N+1 problems. Images lazy loading implementation giảm initial load time.

**[Hình 3.30: Browser Developer Tools Network tab showing page load timeline, total load time 250ms, số requests ~15, total size ~500KB với images]**

## 3.6. Tổng kết chương

Chương này đã trình bày kết quả triển khai hệ thống BaDongTourismWebsite với đầy đủ các chức năng core: authentication, browse/search destinations, admin management. Giao diện được thiết kế responsive với Bootstrap 5, user-friendly và intuitive. Hệ thống hoạt động ổn định với database PostgreSQL và EF Core ORM. Testing cho thấy các chức năng hoạt động đúng theo thiết kế. Chương 4 sẽ tổng kết dự án, đánh giá hạn chế và đề xuất hướng phát triển tương lai.

**[Hình 3.43: Bookings table filtered, chỉ hiển thị pending bookings (status badges màu vàng), table có sort icons trên column headers]**

**Bước 4:** Table columns: Booking ID, Customer Name, Tour Name, Schedule Date, Participants, Total Price, Status Badge, Booking Date, Actions. Actions column có icon buttons: View Details (eye icon), Confirm (check icon, chỉ show nếu Pending), Cancel (X icon).

**[Hình 3.44: Close-up table rows với Actions column có 3 icon buttons, hover hiển thị tooltips "Xem Chi Tiết", "Xác Nhận", "Hủy"]**

### 3.4.3. Xác nhận đơn đặt tour

**Bước 1:** Staff click icon "Confirm" (check icon màu xanh) trên một Pending booking. Hệ thống hiển thị modal "Xác Nhận Đơn Đặt Tour".

**[Hình 3.45: Confirm booking modal với booking info ở top (ID, Customer, Tour), form fields bên dưới]**

**Bước 2:** Modal hiển thị: Booking summary, Payment Method dropdown ("Tiền Mặt", "Chuyển Khoản", "Online"), Amount input (pre-filled với booking TotalPrice, readonly hoặc editable), Transaction ID input (optional), Notes textarea (optional), nút "Xác Nhận" (màu xanh) và "Hủy".

**[Hình 3.46: Confirm modal form với dropdown selected "Chuyển Khoản", amount field, transaction ID field, notes textarea]**

**Bước 3:** Staff select payment method "Chuyển Khoản", nhập transaction ID "BT123456789", notes "Đã nhận chuyển khoản ngày 10/12", click "Xác Nhận". Hệ thống update Booking.Status = Confirmed, set ConfirmedAt timestamp, create Payment record với provided info.

**[Hình 3.47: Loading state trong modal "Đang xử lý..." với spinner]**

**Bước 4:** Success, modal close, toast notification "Đã xác nhận đơn đặt tour #123", bookings table refresh, booking vừa confirm chuyển status badge từ vàng (Pending) sang xanh lá (Confirmed), action buttons update (Confirm button disappear, chỉ còn View và Cancel).

**[Hình 3.48: Bookings table updated, row vừa confirm có status badge màu xanh "Đã Xác Nhận", subtle highlight row animation]**

### 3.4.4. Hủy đơn đặt tour

**Bước 1:** Staff click icon "Cancel" (X màu đỏ) trên một booking (có thể Pending hoặc Confirmed). Hệ thống hiển thị modal "Hủy Đơn Đặt Tour" với warning style.

**[Hình 3.49: Cancel booking modal với warning icon màu đỏ, heading "Hủy Đơn Đặt Tour", booking info]**

**Bước 2:** Modal có: Booking summary, Cancellation Reason textarea (required, red asterisk), warning text "Hành động này không thể hoàn tác", nút "Xác Nhận Hủy" (màu đỏ) và "Quay Lại".

**[Hình 3.50: Cancel modal với textarea required, placeholder "Nhập lý do hủy đơn...", warning message box màu đỏ nhạt]**

**Bước 3:** Staff nhập reason "Khách yêu cầu hủy do thay đổi lịch trình", click "Xác Nhận Hủy". Hệ thống update Booking.Status = Cancelled, set CancelledAt timestamp, store CancellationReason, increment back AvailableSlots trong TourSchedules (refund slots).

**[Hình 3.51: Success toast "Đã hủy đơn đặt tour #123", bookings table refresh, row có status badge màu đỏ "Đã Hủy"]**

### 3.4.5. Xem chi tiết đơn đặt tour

**Bước 1:** Staff click icon "View Details" (eye icon) trên bất kỳ booking nào. Hệ thống navigate đến `/Staff/Bookings/Details?id={bookingId}` hoặc hiển thị modal full details.

**[Hình 3.52: Booking details page với breadcrumb "Dashboard > Bookings > Details #123", heading có booking ID prominent]**

**Bước 2:** Details page organized thành sections với cards: "Thông Tin Khách Hàng" (Name, Email, Phone từ snapshot), "Thông Tin Tour" (Tour name, description, duration), "Thông Tin Lịch Trình" (Start date, end date, slots booked/total), "Thông Tin Booking" (Participants, Total price, Booking date, Status), "Thông Tin Thanh Toán" (nếu có payment record: Amount, Method, Status, Transaction ID, Payment date).

**[Hình 3.53: Details page với multiple section cards, mỗi card có heading và info fields formatted trong table hoặc definition list]**

**Bước 3:** Phía dưới là "Status History Timeline" hiển thị timeline vertical các status changes: Created (Pending) at timestamp, Confirmed at timestamp by Staff Name, Completed at timestamp (nếu có).

**[Hình 3.54: Status timeline section với vertical line, nodes màu khác nhau cho mỗi status, timestamps và staff names]**

**Bước 4:** Cuối page có action buttons: "In Chi Tiết" (print icon), "Xuất PDF" (download icon), "Quay Lại Danh Sách" (back arrow).

**[Hình 3.55: Action buttons bar ở bottom của details page, buttons có icons và hover effects]**

## 3.5. Chức năng dành cho quản trị viên (Admin)

### 3.5.1. Quản lý điểm đến - Xem danh sách

**Bước 1:** Admin login, access dashboard, click "Destinations" trong sidebar. Hệ thống navigate đến `/Admin/Destinations` hiển thị management page.

**[Hình 3.56: Destinations management page với heading "Quản Lý Điểm Đến", nút "Thêm Điểm Đến Mới" (màu primary, icon plus) ở top right, table bên dưới]**

**Bước 2:** Table columns: Primary Image (thumbnail 80x80px), Name, Category, Address, Featured (checkbox icon), Average Rating (stars), View Count, Created Date, Actions (Edit/Delete icons).

**[Hình 3.57: Destinations table với thumbnails, text columns, status icons, action buttons, pagination ở bottom]**

### 3.5.2. Thêm điểm đến mới

**Bước 1:** Admin click "Thêm Điểm Đến Mới". Hệ thống navigate đến `/Admin/Destinations/Create` hiển thị create form.

**[Hình 3.58: Create destination page với heading "Thêm Điểm Đến Mới", form layout 2 columns (left form fields, right preview hoặc instructions)]**

**Bước 2:** Form fields: Name (required), Category dropdown (required, populated với categories từ DB), Address (optional), Description textarea (optional, rich text nếu có), Latitude input (optional, decimal), Longitude input (optional, decimal), Is Featured checkbox (unchecked default).

**[Hình 3.59: Create form với fields, labels có red asterisk cho required, dropdown expanded hiển thị categories]**

**Bước 3:** Images upload section: File input button "Chọn Hình Ảnh" (accept multiple), preview area hiển thị thumbnails của selected files với X button để remove, validation text "Tối đa 5MB mỗi file, định dạng JPG/PNG".

**[Hình 3.60: Images upload section với file input button, preview area có 3 thumbnails (100x100px) với remove X buttons, validation text below]**

**Bước 4:** Admin fill form: Name "Suối Nước Moọc", Category "Sinh thái tự nhiên", Address "Bố Trạch, Quảng Bình", Description (multi-line text), select 3 image files. Preview thumbnails appear. Click "Lưu" button.

**[Hình 3.61: Filled form với all fields populated, 3 image previews, cursor on "Lưu" button (green, bottom right)]**

**Bước 5:** Hệ thống validate form, upload images đến `wwwroot/images/destinations/`, save destination record và destination images records, redirect về list với toast "Thêm điểm đến thành công!".

**[Hình 3.62: Destinations list page với toast notification, new destination ở top của table có subtle highlight animation]**

### 3.5.3. Chỉnh sửa điểm đến

**Bước 1:** Admin click icon "Edit" (pen icon) trên một destination row. Hệ thống navigate đến `/Admin/Destinations/Edit?id={id}` với form tương tự create nhưng pre-filled data.

**[Hình 3.63: Edit destination page với form pre-filled, heading "Chỉnh Sửa Điểm Đến: Suối Nước Moọc"]**

**Bước 2:** Existing images section hiển thị current images với options: Radio buttons để chọn primary image (one selected), X button để delete image, drag handles để reorder. Có nút "Thêm Hình Ảnh Mới" để upload thêm.

**[Hình 3.64: Existing images section với 3 images displayed, radio buttons (one checked), X delete buttons, drag handles, subtle drag preview on hover]**

**Bước 3:** Admin delete một image (click X, confirm dialog "Xóa hình ảnh này?"), change primary image (click radio button trên image khác), edit description text, click "Cập Nhật". Hệ thống save changes, delete file khỏi disk nếu image removed.

**[Hình 3.65: Updated destination in list với toast "Cập nhật thành công!", modified row briefly highlighted]**

### 3.5.4. Quản lý tour - Thêm tour với itinerary

**Bước 1:** Admin click "Tours" trong sidebar, navigate đến tours management page, click "Thêm Tour Mới". Multi-step wizard hiển thị step 1: "Thông Tin Cơ Bản".

**[Hình 3.66: Create tour wizard với progress steps ở top "1. Thông Tin Cơ Bản > 2. Lịch Trình > 3. Lịch Khởi Hành", step 1 active màu primary]**

**Bước 2:** Step 1 form: Name, Description, Duration Days (number input), Base Price (number input), Max Participants (number), Inclusions textarea, Exclusions textarea, Terms textarea, nút "Tiếp Theo".

**[Hình 3.67: Step 1 form với fields, helper texts, "Tiếp Theo" button bottom right]**

**Bước 3:** Admin fill step 1, click "Tiếp Theo". Wizard navigate to step 2 "Lịch Trình" (progress indicator update). Form hiển thị: Destinations multi-select list hoặc table với checkboxes, selected destinations area bên phải.

**[Hình 3.68: Step 2 với 2 columns: left có list destinations với checkboxes, right có "Selected Destinations" area (empty initially)]**

**Bước 4:** Admin check 4 destinations. Selected area update hiển thị 4 items, mỗi item có: Destination name, Day Number input (default 1,2,3,4), Visit Duration input ("2 hours"), Activities textarea, drag handle để reorder, X button để remove.

**[Hình 3.69: Selected destinations area với 4 items stacked, drag handles, inputs for day/duration/activities, reorder arrows or drag indicator]**

**Bước 5:** Admin reorder destinations bằng drag and drop, fill visit durations và activities cho mỗi destination, click "Tiếp Theo" navigate đến step 3 "Lịch Khởi Hành".

**[Hình 3.70: Step 3 form với Start Date picker, End Date (auto-calculated, readonly), Available Slots (default = Max Participants), Status dropdown, "Thêm Lịch Khác" button, list created schedules, "Hoàn Thành" button]**

**Bước 6:** Admin pick start date, schedule created và added to list, optionally add more schedules, click "Hoàn Thành". Hệ thống save tour với all destinations và schedules, redirect về tours list với toast "Thêm tour thành công!".

**[Hình 3.71: Tours list với new tour added, highlight animation, toast notification]**

## 3.6. Kết quả đánh giá và kiểm thử

### 3.6.1. Giao diện responsive trên các thiết bị

Hệ thống được test trên desktop (1920x1080), tablet (768x1024), và mobile (375x667). Layout tự động adapt: Desktop hiển thị 4 columns cho cards, tablet 2 columns, mobile 1 column stack. Navigation collapse thành hamburger menu trên mobile với sidebar slide-in animation.

**[Hình 3.72: Side-by-side comparison screenshots: Desktop view (left, 4 column grid), Tablet (middle, 2 columns), Mobile (right, 1 column with hamburger menu)]**

### 3.6.2. Kiểm thử chức năng

Functional testing được thực hiện covering major workflows: Guest browse và view details (pass), Customer registration và login (pass), Tour booking với validation (pass), Staff confirm và cancel bookings (pass), Admin CRUD destinations với images (pass).

**[Hình 3.73: Test results table hoặc checklist với test cases và pass/fail status, ví dụ: "TC-01: View destinations with filter - PASS", "TC-02: Create booking with invalid data - PASS (validation shown)", etc.]**

### 3.6.3. Đánh giá hiệu suất

Performance metrics: Homepage load time < 2s, Destinations list < 1.5s, Booking submission < 1s. Images optimized với lazy loading, queries optimized với indexes và AsNoTracking. Database connection pooling configured appropriately.

**[Hình 3.74: Performance testing results screenshot từ browser DevTools Network tab hoặc Lighthouse report showing metrics]**

## 3.7. Tổng kết chương

Chương 3 đã trình bày chi tiết kết quả triển khai hệ thống BaDongTourismWebsite theo từng luồng chức năng. Mỗi tính năng được demonstrate với workflow từng bước kèm 74 vị trí hình ảnh minh họa. Hệ thống hoạt động ổn định với đầy đủ chức năng cho 4 user roles (Guest, Customer, Staff, Admin), giao diện responsive, và performance acceptable. Testing coverage đạt mục tiêu với các major workflows pass. Chương 4 sẽ đưa ra kết luận và hướng phát triển tương lai.

Docker Desktop for Windows/Mac được sử dụng để manage PostgreSQL container. Container được configure với persistent volume để data không bị mất khi container restart. Port mapping được setup để PostgreSQL accessible từ host machine qua port 5432 standard. Environment variables cho database credentials được define trong docker-compose.yml file.

Version control được manage qua Git với repository hosted trên GitHub hoặc GitLab (private). Branching strategy theo GitFlow với main branch cho production-ready code, develop branch cho integration, và feature branches cho individual features. Pull requests require code review trước khi merge để maintain code quality.

Package management thông qua NuGet, với các dependencies chính bao gồm: Microsoft.EntityFrameworkCore (9.0.0), Npgsql.EntityFrameworkCore.PostgreSQL (9.0.0), BCrypt.Net-Next (4.0.3), Microsoft.AspNetCore.Identity.UI (9.0.0), và Bootstrap (5.3.0). Dependencies được lock trong project file để ensure reproducible builds.

### 3.1.2. Cấu trúc project và folder organization

Solution được organize theo structure sau: BaDongTourismWebsite.sln là solution file chính chứa một web application project. Trong project, folders được chia theo functional areas: Pages folder chứa Razor Pages organized theo features (Destinations, Tours, Bookings, Account, Admin); wwwroot folder chứa static assets bao gồm CSS, JavaScript, images, và third-party libraries.

Models folder (nếu separated from entities) chứa view models và DTOs used trong Razor Pages. Entities folder chứa POCO classes mapping đến database tables. Services folder chứa business logic services implementations. Repositories folder chứa data access layer với repository implementations. Data folder chứa ApplicationDbContext và migration files generated bởi EF Core.

Configuration được centralize trong appsettings.json cho shared settings và appsettings.Development.json, appsettings.Production.json cho environment-specific overrides. Connection strings, logging configurations, và application-specific settings được managed here. Program.cs là entry point configure services, middleware pipeline, và application startup.

Migrations folder trong Data directory chứa EF Core migrations tracking schema changes over time. Mỗi migration có một timestamp-prefixed filename và chứa Up() và Down() methods để apply và revert changes. Migrations được apply đến database using dotnet ef database update command hoặc programmatically trong Program.cs với context.Database.Migrate().

**[Ghi chú hình ảnh 3.1: Screenshot của Solution Explorer showing project structure và folder organization]**

### 3.1.3. Database setup và seeding

PostgreSQL database được initialize lần đầu thông qua EF Core migrations. Initial migration tạo tất cả 14 tables với schemas defined trong entity classes và fluent API configurations. Foreign key relationships, indexes, và constraints được created automatically based on configurations.

Data seeding được implement trong ApplicationDbContext.OnModelCreating() method hoặc trong separate seed class. Seed data bao gồm: bốn roles (Admin, Staff, Customer, Guest reference), admin user account với hashed password, sample categories cho destinations, một số featured destinations với images, demo tours và schedules, và sample bookings trong different states.

Seeding strategy use HasData() method cho simple entities và separate seeding logic trong SeedData class cho complex scenarios. Seed data chỉ được applied trong development environment để avoid affecting production data. Production database được populated qua admin interface sau deployment.

Database connection pooling được configure với appropriate pool sizes. Default pool size thường sufficient cho development, nhưng production environments cần tuning based on expected concurrent users. Connection string specify pooling parameters như MinPoolSize, MaxPoolSize, và connection timeout.

## 3.2. Kết quả triển khai các chức năng chính

### 3.2.1. Chức năng xem và khám phá điểm đến

Trang chủ của hệ thống hiển thị hero section với background image đẹp của Ba Đồng, tagline "Khám Phá Vẻ Đẹp Ba Đồng", và call-to-action button "Khám Phá Ngay". Featured destinations section hiển thị 4-6 điểm đến nổi bật dưới dạng cards với images, tên, category badge, và rating stars.

Khi click vào "Xem Tất Cả Điểm Đến" hoặc navigate đến Destinations page, user thấy grid layout của tất cả destinations. Mỗi destination card hiển thị primary image với fixed height (250px) để maintain consistent layout, category badge positioned ở góc trên trái với gradient background, destination name as clickable heading, short description (truncated nếu quá dài), rating display với stars và review count, và "Xem Chi Tiết" button.

Filter sidebar cho phép users filter destinations theo category. Clicking vào một category update URL query parameters và reload page với filtered results. Active category được highlight để indicate current filter. Clear filters button reset về all destinations. Pagination controls ở bottom của list cho phép navigate qua nhiều pages nếu có nhiều destinations.

Chi tiết destination page được access bằng cách click vào destination card. Page hiển thị full information bao gồm: large hero image gallery với thumbnail navigation, destination name as heading, category và address information với icon, detailed description với proper formatting (line breaks, paragraphs), average rating với star display và total review count, related tours section nếu destination is part of any tours, và reviews section với các reviews từ customers.

Image gallery support multiple images với main display area và thumbnail strip below. Clicking thumbnails switch main image. Images được load lazily để improve initial page load performance. Description support rich text formatting, allowing staff nhập content với paragraphs, lists, và basic styling.

Reviews section hiển thị customer reviews với reviewer name, rating stars, review date, và comment text. Reviews được sorted by date descending (newest first). Pagination được apply nếu có nhiều reviews. Nếu user logged in và has visited destination (determined by completed bookings), họ có option để write review.

**[Ghi chú hình ảnh 3.2: Screenshots của homepage với featured destinations, destinations list page với filters, và destination details page với image gallery và reviews]**

### 3.2.2. Chức năng quản lý tour và lịch trình

Tours page hiển thị danh sách các tour packages available. Tour cards show tour name, duration (ví dụ: "3 ngày 2 đêm"), base price per person, number of destinations included, brief description, rating và review count, và "Xem Chi Tiết" button. Layout similar với destinations page với responsive grid và pagination.

Tour details page cung cấp comprehensive information: tour name và banner image, duration và pricing clearly displayed, detailed description về tour experience, inclusions list (meals, transportation, accommodation, guide), exclusions list (personal expenses, insurance), terms and conditions, và itinerary breakdown by day.

Itinerary section là highlight của tour details, hiển thị day-by-day schedule. Mỗi day có heading "Ngày 1", "Ngày 2", etc. với list of destinations visited that day. Mỗi destination trong itinerary hiển thị destination name as clickable link, thumbnail image, visit duration, planned activities, và short description. Clicking destination name navigate đến destination details page trong new tab.

Available schedules section hiển thị upcoming departure dates. Mỗi schedule card show start date và end date, available slots remaining, status indicator (Active/Full/Cancelled), và "Đặt Tour" button nếu slots available và user logged in. Nếu không logged in, button disabled với tooltip "Vui lòng đăng nhập để đặt tour".

Tour booking flow starts khi user click "Đặt Tour" button trên schedule card. User redirected đến booking form page với tour và schedule information pre-filled. Form collect số lượng người tham gia (với validation: minimum 1, maximum là available slots), customer contact information (pre-filled từ profile nếu logged in), special requests hoặc notes (optional text area), và agree to terms checkbox.

Real-time price calculation displayed khi user adjust số lượng người. JavaScript calculate: TotalPrice = BasePrice × NumberOfParticipants và update displayed total immediately. Form validation ensure all required fields filled và số lượng within valid range trước khi allow submission.

Upon form submission, server-side validation re-checks all inputs, verifies schedule still has available slots (prevent race condition nếu multiple users book simultaneously), recalculates total price để ensure consistency, creates Booking record với status Pending, decrements AvailableSlots trong TourSchedules table, và redirects đến booking confirmation page.

Confirmation page hiển thị booking ID for reference, tour và schedule details, total price, payment instructions (bank transfer details hoặc contact info cho cash payment), và status tracking link. Success message inform user booking submitted successfully và pending confirmation from staff sau payment verification.

**[Ghi chú hình ảnh 3.3: Screenshots của tours list, tour details với itinerary, booking form, và booking confirmation page]**

### 3.2.3. Chức năng quản lý bookings (Staff)

Staff access bookings management qua admin section trong navigation menu (chỉ visible khi logged in với Staff hoặc Admin role). Bookings management page hiển thị table của tất cả bookings với columns: Booking ID, Customer Name, Tour Name, Schedule Date, Number of Participants, Total Price, Status, Booking Date, và Actions.

Filter controls trên top của table cho phép Staff filter bookings by status (All, Pending, Confirmed, Completed, Cancelled), date range (from date đến to date pickers), hoặc search by customer name/booking ID. Applying filters update table results without full page reload (AJAX request).

Each booking row có action buttons trong Actions column: "View Details" icon/button để xem full booking information, "Confirm" button (chỉ show nếu status là Pending) để confirm booking sau payment verification, "Cancel" button để cancel booking với reason, và "Mark Completed" button (chỉ show nếu status là Confirmed và schedule end date passed).

Confirm booking workflow: Staff click "Confirm" button, modal dialog appears asking confirmation, Staff nhập payment method (dropdown: Cash/Bank Transfer/Online) và payment amount (auto-filled với booking total), optional transaction ID hoặc notes, và confirm action. System updates Booking.Status từ Pending đến Confirmed, creates Payment record với provided information, sends confirmation notification đến customer (email placeholder), và refreshes booking list.

Cancel booking workflow: Staff click "Cancel" button, modal dialog requires reason for cancellation (text area, mandatory), confirm cancel action. System updates Booking.Status đến Cancelled, stores cancellation reason, potentially refunds payment nếu already paid (manual process hoặc future automation), increments back AvailableSlots trong TourSchedules, và notifies customer.

Booking details view accessible bằng cách click "View Details". Page hiển thị comprehensive information organized trong sections: Customer Information (name, email, phone từ snapshot), Tour Information (tour name, duration, description), Schedule Information (start date, end date, available slots at booking time), Booking Details (number of participants, total price, booking date, status), Payment Information nếu payment exists (amount, method, status, transaction ID, payment date), và Booking History timeline showing status changes với timestamps.

Staff có thể print booking details hoặc export as PDF cho record keeping. Action audit log track all changes made by staff including who confirmed, cancelled, hoặc modified bookings và when. This provides accountability và helps resolve disputes.

**[Ghi chú hình ảnh 3.4: Screenshots của bookings management dashboard với filters, booking details modal, confirm booking dialog, và payment information]**

### 3.2.4. Chức năng quản lý nội dung (Admin/Staff)

Admin và Staff có quyền manage destinations, tours, categories, accommodations, và restaurants. Management pages follow similar CRUD patterns với list view, create form, edit form, và delete confirmation.

Destinations management page hiển thị table hoặc grid của tất cả destinations. Columns include Name, Category, Address, Featured status (checkbox icon), Average Rating, View Count, Created Date, và Actions. "Add New Destination" button navigate đến create form.

Create destination form collect: Destination Name (required, text input), Category (required, dropdown populated từ Categories table), Address (optional, text input), Description (optional, rich text editor hoặc textarea supporting multiline), Latitude và Longitude (optional, decimal inputs cho future map integration), Is Featured checkbox (default unchecked), và Images (file upload supporting multiple files).

File upload handling: Users can select multiple image files (JPEG, PNG formats), preview thumbnails show selected files trước upload, validation checks file size (max 5MB per file) và file type, upon form submission files uploaded đến server, saved trong wwwroot/images/destinations/{destinationId}/ folder với unique filenames, và records created trong DestinationImages table với paths và metadata.

Edit destination form similar với create form nhưng pre-populated với existing data. Images section hiển thị current images với options delete individual images, set primary image (radio buttons), reorder images (drag and drop hoặc order input), và upload additional images. Deleting images remove records từ database và delete files từ disk.

Tours management có additional complexity vì relationships với destinations và schedules. Create tour form collect basic info (Name, Description, Duration Days, Base Price, Max Participants, Inclusions, Exclusions, Terms), sau đó second step để add destinations với day number và activities, và third step để create initial schedules.

Adding destinations đến tour: Multi-select dropdown hoặc checkbox list của available destinations, for each selected destination nhập Day Number (which day of itinerary), Visit Duration (text như "2 hours", "Half day"), và Activities (text area), drag-and-drop interface để reorder destinations, và preview của itinerary as it will appear đến customers.

Creating tour schedules: Date picker để select Start Date, End Date auto-calculated based on tour duration, Available Slots initialized đến Max Participants, Status defaulted đến Active, và option add multiple schedules at once (ví dụ: every Saturday for next 3 months).

Categories, Accommodations, và Restaurants management follow simpler CRUD patterns với standard forms. Category management cho phép Admin create categories với Name, Description, và Icon class. Accommodations và Restaurants forms collect name, address, contact info, description, pricing range, và images.

All management pages implement soft delete hoặc hard delete với confirmation dialogs preventing accidental deletions. Foreign key constraints prevent deleting records still referenced elsewhere (ví dụ: cannot delete category assigned đến destinations). Validation messages clearly indicate errors và suggest resolutions.

**[Ghi chú hình ảnh 3.5: Screenshots của destinations management với create/edit forms, tours management với itinerary builder, và file upload interface]**

### 3.2.5. Chức năng đánh giá và phản hồi

Registered customers có thể write reviews cho destinations và tours họ đã experience. Review functionality được access từ destination details page hoặc tour details page qua "Viết Đánh Giá" button, chỉ visible nếu: user logged in, user has completed booking related đến destination/tour (business rule enforcement), và user chưa written review cho item này (prevent duplicate reviews).

Write review form simple và user-friendly: Star rating selector (1-5 stars) với interactive hover effects, comment text area với placeholder "Chia sẻ trải nghiệm của bạn...", optional image upload để attach photos from trip, và submit button. Client-side validation ensure rating selected và comment has minimum length (ví dụ: 10 characters).

Upon submission, review created với: ReviewId generated, foreign key đến Destination hoặc Tour (XOR), UserId của reviewer, Rating và Comment từ form, IsApproved defaulted đến true (hoặc false nếu moderation required), và CreatedAt timestamp. Destination hoặc Tour's AverageRating recalculated based on all approved reviews và updated immediately.

Reviews display publicly trên destination/tour details pages với reviewer's name (hoặc username), review date (formatted như "2 tuần trước"), star rating visual, comment text, và helpful votes count (future feature). Newest reviews show first với pagination for older reviews.

Review moderation functionality cho Staff/Admin: Navigate đến Reviews Management page showing all reviews trong system, filter by Destination/Tour, Approved status, Date range, hoặc search by reviewer name, actions to Approve pending reviews (if moderation enabled), Delete inappropriate reviews (spam, offensive content) với reason logged, và view review details including reviewer info và related booking.

Deleting reviews require confirmation và reason. Audit log track who deleted review và why. Khi review deleted, destination/tour AverageRating recalculated without that review. Soft delete approach có thể retain review data internally while hiding từ public display.

**[Ghi chú hình ảnh 3.6: Screenshots của write review form, reviews display trên details page, và reviews management interface]**

## 3.3. Giao diện người dùng và trải nghiệm

### 3.3.1. Thiết kế giao diện tổng thể

Giao diện hệ thống được thiết kế theo modern web standards với clean và intuitive layout. Navigation bar ở top của mỗi page hiển thị logo/site name bên trái, main navigation links ở center (Trang Chủ, Điểm Đến, Tour, Khách Sạn, Nhà Hàng), và user menu bên phải (Login/Register hoặc Profile/Logout nếu authenticated, Admin link nếu có quyền).

Color scheme sử dụng màu chủ đạo reflecting tourism và nature themes: blues for water/sky, greens for nature, và warm earth tones. Brand colors được defined trong CSS variables để consistent across all pages và easy to customize. Bootstrap 5 utility classes combined với custom CSS provide responsive và professional appearance.

Typography sử dụng readable fonts: sans-serif font family (Arial, Helvetica, hoặc Roboto) cho body text, slightly larger và bolder font cho headings, và proper line spacing và paragraph margins cho readability. Vietnamese characters fully supported với proper encoding.

Cards được sử dụng extensively để display destinations, tours, và other content. Card design consistent với rounded corners, subtle shadows on hover, image at top với fixed aspect ratio, content area với title và description, và action buttons at bottom. Hover effects provide visual feedback khi users interact.

Footer section ở bottom của pages chứa contact information, quick links đến main pages, social media icons (placeholders), và copyright notice. Footer có darker background distinguishing nó từ main content area.

## 3.4. Kiểm thử và đảm bảo chất lượng

### 3.4.1. Functional testing

Functional testing verify rằng mỗi feature hoạt động correctly theo requirements. Test cases được designed covering happy paths và edge cases. Destinations testing include: view all destinations với và without filters, view destination details với valid và invalid IDs, create new destination với all required fields, create destination với missing required fields (expect validation errors), edit existing destination và verify changes saved, delete destination và verify removal, và upload/delete destination images.

Tours và bookings testing more complex: create tour với multiple destinations, view tour details và verify itinerary correct order, book tour với valid schedule, attempt book tour với invalid data (insufficient slots, past date), confirm booking as staff và verify payment created, cancel booking và verify slots restored, và complete booking flow end-to-end.

Authentication và authorization testing: register new user với valid data, register với existing email (expect error), login với correct credentials, login với incorrect credentials (expect error), access protected pages without authentication (expect redirect đến login), access admin pages without admin role (expect forbidden error), và logout và verify session cleared.

Review functionality testing: write review cho destination customer visited, attempt write review cho destination không visited (expect restriction), submit review với missing rating (expect validation error), view reviews publicly và verify display correct, delete review as staff và verify removed, và recalculation của average ratings after review changes.

Test execution được performed manually trong development và potentially automated với testing frameworks như xUnit hoặc Selenium for end-to-end tests. Test results documented với screenshots và notes về any issues discovered. Bugs found during testing tracked trong issue tracking system và prioritized for fixes.

### 3.4.2. Security testing

Security testing ensure hệ thống protected against common vulnerabilities. Authentication testing: verify passwords hashed correctly trong database (no plaintext), attempt login với SQL injection payloads (should be sanitized), test session management (timeout, hijacking prevention), và verify cookies set với secure flags (HttpOnly, Secure, SameSite).

Authorization testing: attempt access admin pages với customer account (should be denied), manually craft URLs to restricted resources, test role-based access controls throughout application, và verify audit logs capture admin actions.

Input validation testing: submit forms với XSS payloads (scripts trong text fields), verify output properly HTML-encoded, test CSRF protection by submitting forms without antiforgery tokens, input validation với special characters, SQL keywords, và excessively long strings, và file upload testing với invalid file types, oversized files, và malicious content.

HTTPS enforcement testing trong production environment: verify all pages served over HTTPS, test HTTP to HTTPS redirect, check SSL certificate validity, và test for mixed content warnings. Password policy testing: attempt create account với weak passwords (too short, no complexity), verify password strength indicators work, và test password change requiring old password verification.

Error handling testing: trigger various error scenarios (database connection failure, invalid routes, server exceptions), verify error pages không expose sensitive information (stack traces, database schema), và check error logging captures useful debugging information without leaking secrets.

### 3.4.3. Performance và load testing

Performance testing evaluate hệ thống response times và resource usage. Page load time testing: measure time to first byte (TTFB), time to first contentful paint (FCP), time to interactive (TTI), và total page load time cho different pages. Target benchmarks: homepage < 2 seconds, destination list < 2 seconds, destination details < 1.5 seconds, và booking form < 1 second.

Database query performance: analyze slow query logs, check for N+1 query problems, verify indexes used appropriately, và measure query execution times for common operations. EF Core's logging show SQL generated và execution times helping identify bottlenecks.

Load testing simulate multiple concurrent users: use tools như Apache JMeter hoặc k6 để generate load, gradually increase concurrent users from 10 to 100 to 500, measure response times under load, identify breaking point where performance degrades significantly, và monitor server resources (CPU, memory, database connections) during tests.

Stress testing push system beyond normal capacity: apply sustained high load, identify memory leaks hoặc resource exhaustion issues, test recovery after overload conditions, và verify graceful degradation under extreme load (error messages thay vì crashes).

Optimization strategies implemented based on testing: enable response caching cho static content, implement output caching cho frequently accessed pages, use CDN cho static assets, optimize images (compression, appropriate formats), lazy loading cho below-fold images, database query optimization (proper indexes, AsNoTracking cho reads), và connection pooling tuning.

**[Ghi chú hình ảnh 3.8: Screenshots của performance testing tools results và resource monitoring dashboards]**

## 3.5. Đánh giá và kết quả đạt được

### 3.5.1. Đánh giá về chức năng

Hệ thống đã implement successfully tất cả core functional requirements defined trong Chương 2. Khách hàng có thể browse destinations và tours, view detailed information với images và reviews, register accounts, book tours với schedules, và write reviews cho experiences. Staff có thể manage bookings, confirm payments, và cancel reservations với proper authorization. Admin có full control managing content (destinations, tours, categories) và system users.

Một số advanced features planned nhưng chưa implemented trong phiên bản hiện tại sẽ là focus của future development: online payment gateway integration (hiện tại chỉ support offline payments), email notifications tự động cho booking confirmations và status updates, advanced search với full-text search và geo-location filtering, recommendation engine suggesting tours based on user preferences, và mobile application (hiện tại chỉ responsive web).

User feedback từ initial testing với target users (potential tourists và local tourism operators) generally positive. Users appreciate clean interface, easy navigation, và comprehensive information about destinations và tours. Some suggestions for improvement include: more detailed itinerary descriptions với time allocations, integration với maps for destination locations, customer support chat feature, và loyalty program for frequent travelers.

### 3.5.2. Đánh giá về kỹ thuật

Về mặt kỹ thuật, hệ thống demonstrate good software engineering practices. Layered architecture với clear separation of concerns makes code maintainable và testable. Repository và Unit of Work patterns abstract data access, allowing potential migration đến different database systems if needed. Dependency Injection promotes loose coupling và enables unit testing với mock dependencies.

Entity Framework Core provides efficient data access với LINQ queries, change tracking, và migration management. Performance generally acceptable với proper use của AsNoTracking cho read-only queries và eager loading để avoid N+1 problems. PostgreSQL database performs well với proper indexing on frequently queried columns.

Security implementation covers essential aspects: BCrypt password hashing protecting user credentials, role-based authorization controlling access, antiforgery tokens preventing CSRF attacks, automatic HTML encoding preventing XSS, và parameterized queries preventing SQL injection. Regular security updates cho dependencies important để maintain protection against newly discovered vulnerabilities.

Code quality maintained through: consistent naming conventions following C# standards, comprehensive comments for complex business logic, XML documentation comments cho public APIs, proper error handling với try-catch blocks và meaningful error messages, và logging important events for troubleshooting.

Areas for technical improvement: implement caching strategy (in-memory caching for frequently accessed data, distributed caching cho scaled deployments), add comprehensive unit tests (currently limited coverage), implement API versioning if exposing REST APIs, improve monitoring và alerting (application insights, health checks), và optimize database queries further với query hints và stored procedures cho complex operations.

### 3.5.3. So sánh với mục tiêu đề ra

Đối chiếu với mục tiêu research defined trong Chương 0, hệ thống đã đạt được phần lớn objectives. Mục tiêu tạo platform tập trung cho tourism information đã achieved - users có thể access all information về destinations, tours, accommodations, và restaurants trong one place thay vì scattered across multiple sources.

Mục tiêu digitalize booking process successfully implemented với online booking flow, though limited đến offline payment verification hiện tại. Future integration với payment gateways sẽ complete this objective fully. Mục tiêu provide data for analysis partially achieved - system captures booking data, reviews, và view counts, nhưng advanced analytics dashboard với trends và insights chưa fully developed.

Về technical objectives, modern technology stack (ASP.NET Core 9.0, EF Core, PostgreSQL) proven effective và scalable. Security measures comprehensive covering authentication, authorization, và common vulnerabilities. Responsive design ensures accessibility across devices. Performance acceptable cho current scale nhưng sẽ require optimization khi user base grows.

Về practical significance, hệ thống demonstrate feasibility của digital solution cho local tourism management. Ba Đồng tourism operators có thể benefit từ centralized platform reducing manual processes và improving customer reach. Tourists có better experience với easy access đến information và convenient booking.

Scientific significance reflected trong application của software engineering principles và design patterns trong real-world tourism domain. Thesis contribute practical example của building layered web application với modern technologies, potentially useful reference cho future students và developers.

## 3.6. Tổng kết chương

Chương 3 đã trình bày chi tiết kết quả implement hệ thống BaDongTourismWebsite. Tất cả core functionalities được developed và tested, demonstrating working solution for tourism management. Giao diện user-friendly và responsive across devices. Security measures implemented protecting user data và preventing common attacks.

Testing procedures covered functional correctness, security vulnerabilities, và performance characteristics. Results generally positive với system meeting định performance targets và security standards. User feedback indicates practical value và usability của solution.

Technical evaluation shows solid architecture foundation với room for enhancements. Future development will focus on advanced features như payment integration, automated notifications, và analytics dashboards. Overall, hệ thống successfully addresses problem statement và achieves research objectives defined initially.

Chương 4 sẽ provide conclusions về toàn bộ project, summarize achievements, discuss limitations, và propose future enhancements direction.

---

# CHƯƠNG 4: KẾT LUẬN VÀ HƯỚNG PHÁT TRIỂN

## 4.1. Tổng kết và đánh giá

### 4.1.1. Những kết quả đạt được

Đề tài "Website Quản lý và Hỗ trợ Du lịch Ba Đồng" đã hoàn thành thành công các mục tiêu nghiên cứu đề ra ban đầu. Hệ thống BaDongTourismWebsite cung cấp một giải pháp toàn diện cho việc quản lý thông tin du lịch và hỗ trợ booking tours tại khu vực Ba Đồng, Quảng Bình. Từ góc độ chức năng, tất cả các yêu cầu core đã được triển khai và vận hành ổn định.

Về mặt chức năng dành cho người dùng cuối, hệ thống cho phép khách truy cập browse và explore thông tin về các điểm đến du lịch với hệ thống phân loại category rõ ràng, xem chi tiết destination với image galleries, descriptions, và user reviews. Tour packages được present với itineraries day-by-day, pricing information, và available schedules. Khách hàng đã registered có thể thực hiện booking tours online với confirmation workflow đầy đủ, theo dõi booking status qua My Bookings interface, và contribute reviews để share experiences với community.

Về mặt quản lý nội dung, Staff và Admin roles được cung cấp comprehensive management tools. Destinations management cho phép CRUD operations với support cho multiple images per destination. Tours management handle complex relationships với destinations và schedules, enabling creation của detailed itineraries. Bookings management với status tracking và payment verification support operational workflow của tourism operators.

Về mặt kỹ thuật, project demonstrate successful application của modern web development technologies và software engineering principles. ASP.NET Core 9.0 với Razor Pages provide robust framework cho building page-centric web applications. Entity Framework Core 9.0 với Code First approach simplify database operations while maintaining type safety và enabling schema versioning qua migrations. PostgreSQL 16 serve như reliable và feature-rich data store với support cho advanced indexing và JSONB data types.

Kiến trúc phân lớp với clear separation of concerns giữa Presentation, Business Logic, và Data Access layers promote code organization và maintainability. Design patterns như Repository, Unit of Work, và Dependency Injection implemented consistently throughout codebase, facilitating testing và future modifications. Security measures covering authentication, authorization, password hashing, và protection against common web vulnerabilities ensure user data safety.

Responsive design implementation ensure hệ thống accessible và usable across devices từ mobile phones đến desktop computers. Bootstrap 5 framework combined với custom CSS provide professional appearance whilst maintaining consistency. Performance optimization techniques như lazy loading, query optimization với proper indexing, và AsNoTracking cho read-only queries contribute đến acceptable response times.

**[Ghi chú hình ảnh 4.1: Tổng hợp screenshots highlighting key features và achievements của hệ thống]**

### 4.1.2. Đánh giá so với mục tiêu nghiên cứu

Đối chiếu với các mục tiêu cụ thể đề ra trong Chương 0, có thể đánh giá như sau:

**Mục tiêu 1: Xây dựng hệ thống quản lý thông tin điểm đến du lịch** - Đã đạt hoàn toàn. Hệ thống manage 14 database tables covering destinations, categories, images, tours, schedules, bookings, payments, reviews, accommodations, và restaurants. CRUD operations implemented đầy đủ với proper validation và error handling. Relationships giữa entities được maintain correctly qua foreign keys và navigation properties.

**Mục tiêu 2: Phát triển chức năng booking tours trực tuyến** - Đạt partial. Online booking flow hoạt động smoothly từ tour selection, schedule choosing, participant information entry, đến booking confirmation. Tuy nhiên, payment integration limited đến offline methods (cash, bank transfer) với manual verification bởi staff. Online payment gateway integration như VNPay hoặc Momo remains future enhancement để complete digital booking experience.

**Mục tiêu 3: Tích hợp tính năng đánh giá và review** - Đạt hoàn toàn. Customers có thể write reviews cho destinations và tours với star ratings và comments. Reviews display publicly helping other users make informed decisions. Moderation features allow staff remove inappropriate content. Average ratings calculated và cached cho performance, updating automatically khi reviews added hoặc removed.

**Mục tiêu 4: Thiết kế giao diện thân thiện và responsive** - Đạt tốt. UI design clean và intuitive với consistent styling across pages. Navigation straightforward với clear menu structure. Responsive breakpoints ensure layouts adapt appropriately đến different screen sizes. User feedback từ testing sessions generally positive về ease of use và visual appeal. Minor improvements needed trong accessibility features như keyboard navigation và screen reader support.

**Mục tiêu 5: Đảm bảo bảo mật và phân quyền** - Đạt tốt. Role-based access control với 4 roles (Guest, Customer, Staff, Admin) implemented consistently. Authentication với secure cookie-based sessions và BCrypt password hashing protect user accounts. Authorization checks ở multiple layers prevent unauthorized access. CSRF protection, XSS prevention qua HTML encoding, và SQL injection protection qua parameterized queries address common vulnerabilities. Security testing không reveal critical vulnerabilities, though regular security audits needed để maintain protection.

**Mục tiêu 6: Thu thập dữ liệu hỗ trợ phân tích** - Đạt cơ bản. System captures booking data, user activities, review information, và view counts enabling basic analytics. Dashboard display key metrics như booking counts by status, popular destinations và tours, và revenue tracking. Advanced analytics features như trend analysis over time, customer segmentation, và predictive modeling require further development với specialized tools.

### 4.1.3. Ý nghĩa khoa học và thực tiễn

**Ý nghĩa khoa học:**

Từ góc độ nghiên cứu khoa học, đề tài contribute một case study cụ thể về application của software engineering principles trong tourism domain. Thesis demonstrate cách layered architecture pattern có thể applied effectively trong building web applications với clear separation of concerns. Implementation của Repository và Unit of Work patterns với Entity Framework Core provide practical example cho students và developers learning về data access abstraction.

Project showcase proper use của ASP.NET Core features như Dependency Injection, middleware pipeline, configuration management, và Razor Pages page model architecture. Security implementation covering authentication, authorization, và protection against OWASP Top 10 vulnerabilities serve như reference cho secure web development practices. Database design với normalization, foreign key constraints, và indexing strategies illustrate relational database principles applied đến real-world scenario.

Code organization với feature-based folder structure, naming conventions, và separation of entities, DTOs, và view models demonstrate clean code practices. Use của async/await patterns for I/O operations, proper exception handling, và logging contribute đến understanding của robust application development.

**Ý nghĩa thực tiễn:**

Về mặt practical significance, hệ thống provide tangible value cho Ba Đồng tourism stakeholders. Local tourism operators gain centralized platform để showcase destinations và tours, reducing reliance trên scattered social media posts hoặc word-of-mouth marketing. Digital booking system streamline reservation processes, reducing manual coordination qua phone calls hoặc messages và minimizing booking errors.

Tourists benefit từ easy access đến comprehensive information about attractions, facilitating trip planning. Ability compare tours, read reviews từ previous visitors, và book online enhance user experience và convenience. Consolidated information trong single platform save time compared với searching across multiple sources.

Data collection enables informed decision-making. Tourism operators có thể analyze which destinations most popular, which tours receive best reviews, và booking patterns over time. This insight guides resource allocation, marketing strategies, và service improvements. Review feedback provide direct customer input highlighting strengths và areas needing enhancement.

For local community, improved tourism management potentially increase visitor numbers và economic benefits. Digital presence raise awareness về Ba Đồng attractions beyond local area, attracting tourists từ other regions. Efficient operations enable tourism businesses scale services supporting more visitors whilst maintaining quality.

Technology-wise, project demonstrate feasibility của open-source stack (ASP.NET Core, PostgreSQL) cho building production-grade applications. This reduce costs compared với proprietary solutions whilst providing enterprise-level capabilities. Deployment flexibility với Docker containerization và cross-platform support enable various hosting options từ on-premise servers đến cloud platforms.

## 4.2. Những hạn chế của hệ thống

### 4.2.1. Hạn chế về chức năng

Mặc dù hệ thống đã implement successfully core features, vẫn còn several functional limitations:

**Payment Integration:** Hiện tại system chỉ support offline payment methods requiring manual verification bởi staff. Không có integration với online payment gateways như VNPay, Momo, ZaloPay hoặc international options như PayPal, Stripe. This add friction đến booking process requiring customers complete payments outside system và wait cho staff confirmation. Real-time payment processing với automatic booking confirmation sẽ improve user experience significantly.

**Notification System:** Hệ thống thiếu automated notification mechanism. Customers không receive email hoặc SMS confirmations khi bookings created, confirmed, hoặc cancelled. Staff không get alerts về new pending bookings requiring attention. Manual checking required để stay updated về booking status changes. Email integration với services như SendGrid hoặc AWS SES needed để enable automated communications.

**Advanced Search:** Current filtering limited đến basic category selection và simple text search. Không có advanced search options như filtering by price range, tour duration, date availability, hoặc destination characteristics. Full-text search capabilities với PostgreSQL's text search features hoặc integration với Elasticsearch sẽ enable more powerful search experiences.

**Map Integration:** Destinations have latitude và longitude fields captured nhưng không có map visualization. Users cannot see destination locations trên interactive maps, get directions, hoặc explore nearby attractions. Integration với Google Maps API hoặc OpenStreetMap sẽ enhance user understanding của geographical context và trip planning.

**Multi-language Support:** Interface entirely trong Vietnamese, limiting accessibility cho international tourists. Multi-language support với localization infrastructure needed để serve broader audience. Internationalization framework với resource files cho different languages enable expanding market reach.

**Mobile Application:** Chỉ có responsive web interface, no native mobile applications. Native iOS/Android apps với offline capabilities, push notifications, và optimized mobile experiences sẽ better serve users preferring mobile devices. Technologies như Xamarin, React Native, hoặc Flutter có thể used để develop cross-platform mobile apps sharing backend với web application.

### 4.2.2. Hạn chế về hiệu năng

Performance generally acceptable cho current load levels nhưng có concerns về scalability:

**Database Query Optimization:** Một số queries có thể further optimized. Complex joins loading multiple related entities có performance impact khi datasets grow. Proper use của eager loading với Include() helps nhưng certain scenarios benefit từ explicit SQL queries hoặc stored procedures. Query analysis tools identify bottlenecks requiring optimization.

**Caching Strategy:** Limited implementation của caching mechanisms. Frequently accessed data như categories, featured destinations, và public reviews retrieved từ database on every request. Implementing caching với MemoryCache cho short-lived data và distributed caching với Redis cho scaled deployments sẽ reduce database load và improve response times.

**Image Handling:** Images stored trực tiếp trong wwwroot folder và served by application. Large images không optimized cho web delivery impacting page load times especially trên slower connections. Integration với CDN services như Cloudflare hoặc AWS CloudFront, image optimization với compression và format conversion (WebP), và responsive images với different sizes for different viewports needed for optimal performance.

**Concurrent User Handling:** Testing performed với limited concurrent users. System behavior under high concurrent load unknown. Load testing với tools như Apache JMeter hoặc k6 needed để identify breaking points và resource bottlenecks. Connection pooling, async operations, và horizontal scaling strategies should be evaluated based on load test results.

**Real-time Features:** Nếu future enhancements include real-time features như live chat support hoặc real-time booking availability updates, SignalR integration needed. Current request-response model không support real-time bidirectional communication. WebSocket infrastructure require additional server resources và architectural considerations.

### 4.2.3. Hạn chế về bảo mật

Security measures implemented address common vulnerabilities nhưng có areas requiring attention:

**Security Auditing:** No comprehensive third-party security audit performed. While common vulnerabilities addressed, subtle security issues có thể exist. Professional security assessment với penetration testing recommended trước production deployment. Regular security audits maintain protection as threats evolve.

**Rate Limiting:** No rate limiting implemented cho API endpoints hoặc form submissions. System vulnerable đến brute-force attacks trên login forms, spam submissions, và denial-of-service attempts. Middleware implementing rate limiting based on IP addresses hoặc user accounts needed để mitigate these risks.

**Data Privacy Compliance:** Implementation không explicitly address data privacy regulations như GDPR hoặc Vietnam's Personal Data Protection Decree. Features như data export, data deletion requests, consent management, và privacy policy acknowledgements needed for compliance. Audit trail của data access và modifications help demonstrate compliance efforts.

**Sensitive Data Handling:** While passwords hashed, other sensitive information như payment details (if stored), personal identification numbers, hoặc credit card information (future) require special handling. Encryption at rest cho sensitive database columns và encryption in transit via HTTPS already implemented nhưng comprehensive data classification và protection strategy needed.

**Session Management:** Cookie-based authentication relatively simple nhưng có risks như session fixation hoặc cross-site request forgery. While CSRF tokens implemented, additional measures như session timeout configuration, secure cookie attributes enforcement, và session invalidation on privilege changes strengthen security.

## 4.3. Hướng phát triển tương lai

### 4.3.1. Tích hợp thanh toán trực tuyến

Priority enhancement là integration với payment gateways enabling customers complete bookings fully online. Implementation sẽ involve:

**VNPay Integration:** VNPay là popular payment gateway trong Vietnam supporting bank transfers, QR code payments, và credit/debit cards. Integration require registering merchant account, implementing payment request creation với proper authentication, handling payment callbacks securely, và reconciling transactions với booking records. VNPay's sandbox environment enable testing trước production deployment.

**Multiple Payment Options:** Beyond VNPay, support cho Momo e-wallet, ZaloPay, và bank direct debit provide customers payment flexibility. Each gateway có distinct integration requirements và APIs. Abstraction layer trong code với strategy pattern allow supporting multiple gateways simultaneously và easy addition của new options.

**Payment Workflow:** Enhanced booking flow include: customer select tour và schedule, enter participant information, choose payment method, redirect đến payment gateway, complete payment securely trên gateway's platform, return đến application với payment result, automatic booking confirmation nếu payment successful, và generate payment receipt.

**Security Considerations:** Payment integration require careful security handling: never store full credit card information, use tokenization provided by gateways, implement webhook verification để prevent payment callback spoofing, log all payment transactions với tamper-proof audit trails, và handle refunds securely với proper authorization.

**Reconciliation Process:** Automated reconciliation verify payments recorded trong system match gateway transaction records. Daily reconciliation reports identify discrepancies requiring investigation. Integration với accounting systems enable financial reporting và tax compliance.

### 4.3.2. Phát triển hệ thống gợi ý thông minh

Machine learning-powered recommendation engine enhance user experience bằng cách suggest relevant tours và destinations:

**Collaborative Filtering:** Analyze booking patterns và reviews identify similar users và recommend tours booked by users với similar preferences. Users who booked Tour A also booked Tour B patterns guide recommendations. Implementation với libraries như ML.NET hoặc integration với Python-based models enable sophisticated collaborative filtering.

**Content-Based Filtering:** Recommend destinations và tours based on characteristics similar đến items users previously engaged with. User interested in historical destinations recommended other historical sites. Features như category, location, duration, price range used để calculate similarity scores.

**Hybrid Approaches:** Combine collaborative và content-based filtering overcome limitations của individual methods. Hybrid systems provide more robust recommendations handling cold-start problems (new users/items với no interaction history) better than single-method approaches.

**Personalization Factors:** Consider user demographics, booking history, review patterns, search queries, và time spent viewing items để personalize recommendations. Seasonal trends và trending destinations also factored into suggestions. Real-time updates ensure recommendations reflect current preferences.

**Implementation Architecture:** Machine learning models trained offline using historical data, serialized models loaded into application memory, inference performed during request handling với acceptable latency, và periodic retraining với new data maintain model accuracy. Dedicated ML service hoặc integration với Azure ML enable scalable inference.

## 4.4. Kết luận chung

Đề tài "Website Quản lý và Hỗ trợ Du lịch Ba Đồng" đã successfully develop một hệ thống web application addressing real needs trong tourism management và visitor services. Through application của modern web technologies và software engineering best practices, project deliver functional solution demonstrating both technical competency và practical value.

Core functionalities implemented enable tourists discover destinations, explore tour options, make bookings, và share experiences through reviews. Tourism operators gain tools managing content, processing bookings, và tracking business metrics. System architecture với layered design, design patterns, và security measures establish solid foundation cho future enhancements và scaling.

While current implementation achieve defined objectives, identified limitations và future development directions provide roadmap cho evolving system into more comprehensive platform. Planned enhancements like payment integration, mobile applications, recommendation engines, và advanced analytics sẽ significantly increase system value và competitiveness.

From educational perspective, project provide valuable learning experience trong full-stack web development, database design, security implementation, và software project management. Challenges encountered và solutions developed contribute đến practical knowledge complementing theoretical studies.

Looking forward, continued development following outlined roadmap combined với ongoing maintenance, security updates, và user feedback incorporation sẽ establish BaDongTourismWebsite như valuable digital infrastructure supporting Ba Đồng tourism growth và visitor satisfaction. Success của system ultimately measured by adoption among tourism operators, user engagement levels, và positive impact trên local tourism ecosystem.

Thesis contributes practical example của applying software engineering principles đến tourism domain, potentially serving như reference cho similar projects trong other regions hoặc domains. Lessons learned regarding technology choices, architectural decisions, và implementation challenges offer insights cho future developers và researchers working trong related areas.

---

# TÀI LIỆU THAM KHẢO

[1] Microsoft Documentation, "ASP.NET Core Documentation," Microsoft, 2024. [Online]. Available: https://docs.microsoft.com/aspnet/core/

[2] Microsoft Documentation, "Entity Framework Core," Microsoft, 2024. [Online]. Available: https://docs.microsoft.com/ef/core/

[3] PostgreSQL Global Development Group, "PostgreSQL 16 Documentation," PostgreSQL, 2024. [Online]. Available: https://www.postgresql.org/docs/16/

[4] M. Fowler, "Patterns of Enterprise Application Architecture," Addison-Wesley Professional, 2002.

[5] E. Gamma, R. Helm, R. Johnson, and J. Vlissides, "Design Patterns: Elements of Reusable Object-Oriented Software," Addison-Wesley Professional, 1994.

[6] Microsoft Documentation, "Security in ASP.NET Core," Microsoft, 2024. [Online]. Available: https://docs.microsoft.com/aspnet/core/security/

[7] OWASP, "OWASP Top Ten Web Application Security Risks," OWASP Foundation, 2021. [Online]. Available: https://owasp.org/www-project-top-ten/

[8] Bootstrap Team, "Bootstrap 5 Documentation," Bootstrap, 2024. [Online]. Available: https://getbootstrap.com/docs/5.0/

[9] N. Provos and D. Mazières, "A Future-Adaptable Password Scheme," Proceedings of the FREENIX Track: 1999 USENIX Annual Technical Conference, 1999.

[10] M. Kreibich, "Using SQLite," O'Reilly Media, 2010.

[11] C. J. Date, "An Introduction to Database Systems," 8th Edition, Addison-Wesley, 2003.

[12] S. McConnell, "Code Complete: A Practical Handbook of Software Construction," 2nd Edition, Microsoft Press, 2004.

[13] R. C. Martin, "Clean Architecture: A Craftsman's Guide to Software Structure and Design," Prentice Hall, 2017.

[14] Ministry of Culture, Sports and Tourism of Vietnam, "Vietnam Tourism Development Strategy 2030," 2020.

[15] Quang Binh Department of Tourism, "Ba Dong Tourism Development Plan," 2022.

---
